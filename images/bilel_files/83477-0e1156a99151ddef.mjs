(self.modernJsonp=self.modernJsonp||[]).push([["83477"],{379026:function(e,i,t){t.r(i),t.d(i,{default:()=>a});let n={argumentDefinitions:[{kind:"RootArgument",name:"isCloseupRelatedModulesFeedQuery"}],kind:"Fragment",metadata:null,name:"DeprecatedCarousel_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{condition:"isCloseupRelatedModulesFeedQuery",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null}]},{args:null,kind:"FragmentSpread",name:"usePinCarouselData_pin"}],type:"Pin",abstractKey:null};n.hash="95793e1276a19bfa11c2fd12c81bc9af";let a=n},474268:function(e,i,t){var n,a,l;t.r(i),t.d(i,{default:()=>o});let r={argumentDefinitions:[{kind:"RootArgument",name:"isCloseupRelatedModulesFeedQuery"}],kind:"Fragment",metadata:null,name:"PinImage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"altText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"autoAltText",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l=[n={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"474x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"orig")'},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{condition:"isCloseupRelatedModulesFeedQuery",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},a],storageKey:null}],storageKey:null}],storageKey:null}]},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isThirdPartyAd",storageKey:null},{args:null,kind:"FragmentSpread",name:"StoryPinImage_pin"},{args:null,kind:"FragmentSpread",name:"DeprecatedCarousel_pin"}],type:"Pin",abstractKey:null};r.hash="9db52bae6bfdadee41180545715b9262";let o=r},644073:function(e,i,t){t.r(i),t.d(i,{default:()=>a});let n={argumentDefinitions:[{kind:"RootArgument",name:"isCloseupRelatedModulesFeedQuery"}],kind:"Fragment",metadata:null,name:"PinVideoWithVisibility_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{condition:"isCloseupRelatedModulesFeedQuery",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null}]},{args:null,kind:"FragmentSpread",name:"PinVideo_pin"},{args:null,kind:"FragmentSpread",name:"useAutoplayOrgVideoOnHover_pin"}],type:"Pin",abstractKey:null};n.hash="ff86500434f78bdd6ea81969c1825eec";let a=n},751457:function(e,i,t){var n,a;t.r(i),t.d(i,{default:()=>r});let l={argumentDefinitions:[{kind:"RootArgument",name:"isCloseupRelatedModulesFeedQuery"}],kind:"Fragment",metadata:null,name:"PinVideo_pin",selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[a={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"isDownstreamPromotion",storageKey:null},{condition:"isCloseupRelatedModulesFeedQuery",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isEligibleForWebCloseup",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[n,{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"promoter",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PinImage_pin"}],type:"Pin",abstractKey:null};l.hash="6700b53021feabf2b7b65f349edcf8b3";let r=l},682784:function(e,i,t){var n,a,l,r;t.r(i),t.d(i,{default:()=>s});let o=(r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinImage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l=[n={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"474x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"736x")'},{alias:null,args:null,kind:"ScalarField",name:"isDownstreamPromotion",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"promoter",plural:!1,selections:[r],storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinPage",kind:"LinkedField",name:"pages",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blocks",plural:!0,selections:[r,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"blockType",storageKey:null},{alias:null,args:null,concreteType:"StoryPinVideoMetadataFormattedV2",kind:"LinkedField",name:"videoDataV2",plural:!1,selections:[{alias:null,args:[{kind:"Literal",name:"version",value:"V_HLSV3_MOBILE"}],concreteType:"StoryPinVideoFormatsV2",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},a],storageKey:null}],storageKey:'videoList(version:"V_HLSV3_MOBILE")'}],storageKey:null}],type:"StoryPinVideoBlock",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null});o.hash="695074f4aa0e5845fecc8d4bdf773a7e";let s=o},454387:function(e,i,t){t.r(i),t.d(i,{default:()=>a});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoWithContextLogging_pin",selections:[{args:null,kind:"FragmentSpread",name:"VideoWrapper_pin"}],type:"Pin",abstractKey:null};n.hash="93ed23334d5bac81ac8410f05c4f2031";let a=n},46424:function(e,i,t){var n,a;t.r(i),t.d(i,{default:()=>r});let l={argumentDefinitions:[{kind:"RootArgument",name:"isCloseupRelatedModulesFeedQuery"}],kind:"Fragment",metadata:null,name:"useAutoplayOrgVideoOnHover_pin",selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{condition:"isCloseupRelatedModulesFeedQuery",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[n,{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"v720P",plural:!1,selections:a=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:a,storageKey:null}],storageKey:null}],storageKey:null}]},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"totalVideoDuration",storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};l.hash="1348c39b7f31610be1c0d3768e3ee907";let r=l},423858:function(e,i,t){t.r(i),t.d(i,{default:()=>ee});var n,a,l,r,o,s=t(281098),d=t(667294);t(167912);var u=t(20256),c=t(312048),h=t(763387),p=t.n(h),g=t(507438),m=t(284778),y=t(28427),f=t(19585),v=t(302148),x=t(97484),b=t(675973),S=t(97365),k=t(785893);function w(e){return!(e.imageSpec_474x?.width&&e.imageSpec_474x.height&&e.imageSpec_474x.width>e.imageSpec_474x.height)&&e.imageSpec_474x||e.imageSpec_736x}let _=(void 0!==n||(n=t(682784)).hash&&"695074f4aa0e5845fecc8d4bdf773a7e"!==n.hash&&console.error("The definition of 'StoryPinImage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function P({alt:e,fetchPriority:i,onError:t=()=>{},onLoad:n=()=>{},pinKey:a,_fixCompletedOnLoad:l}){(0,d.useEffect)(()=>{(0,s.Z)("StoryPinImage","/app/www/AuthDesktopPinRep/components/StoryPinImage.tsx")},[]);let{checkExperiment:r}=(0,b.Z)(),{anyEnabled:o}=r("ads_iad_dweb"),c=(0,y.Z)(_,a),{dominantColor:h,isDownstreamPromotion:p,promoter:g}=c,m=!!g&&!p,f=function(e){let i=e.storyPinData?.pages||[],t=(i[0]?.blocks||[])[0]||{};return"StoryPinVideoBlock"===t.__typename&&3===t.blockType}(c),{height:v,width:x,url:P}=function({pin:e,useVideoThumbnail:i}){return i?function(e){let i=e.storyPinData?.pages||[],t=i[0]?.blocks||[],n=t[0]?.__typename==="StoryPinVideoBlock"?t[0]?.videoDataV2?.videoList?.vHLSV3MOBILE:null;return n?.thumbnail?{height:n?.height||0,width:n?.width||0,url:n.thumbnail||""}:w(e)}(e):w(e)}({pin:c,useVideoThumbnail:f&&(m&&o||!m)})??{};return(0,k.jsx)(u.xu,{dangerouslySetInlineStyle:{__style:{zIndex:S.Z.storyPinImage}},"data-test-id":"story-pin-image-box",width:"100%",children:P&&(0,k.jsx)(u.Ee,{_fixCompletedOnLoad:l,alt:e,color:h||"transparent",fetchPriority:i,naturalHeight:v??1,naturalWidth:x??1,onError:t,onLoad:n,src:P})})}var T=t(688170),C=t(778058),F=t(39586);let V=["ShoppingCarousel","ShoppingGridSmall","ShoppingGridSmallCarousel","ShoppingDynamicHeightGrid","VisualInspirationFocusPin","VisualInspirationPin","VisualInspirationShoppingPin","ProductTaggingSearchResult"],I=(void 0!==a||(a=t(474268)).hash&&"9db52bae6bfdadee41180545715b9262"!==a.hash&&console.error("The definition of 'PinImage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),a),L=({children:e,cropStoryPinImage:i,cropWidth:t,cropHeight:n})=>i?(0,k.jsx)(u.kC,{alignItems:"center",height:t?n:void 0,justifyContent:"start",width:t||void 0,children:e}):(0,k.jsx)(u.xu,{children:e}),D=({cropHeight:e,cropWidth:i,highResOnly:t,imageFit:n,isInDesktopCarousel:a,onError:l,onLoad:r,pinKey:o,saved:h=!1,surface:b,ssrImpressionFixEnabled:S})=>{(0,d.useEffect)(()=>{(0,s.Z)("PinImage","/app/common/react/components/PinRep/components/PinVisual/PinImage.tsx")},[]);let w=(0,f.Z)(),_=(0,T.C)((0,c.TH)()),D=(0,y.Z)(I,o),{altText:j,autoAltText:K,carouselData:E,description:R="",dominantColor:W,gridTitle:Z,isThirdPartyAd:A,title:M,videos:H}=D,B=(0,v.nk)(w._('This contains an image of: {{ pinTitle }}', 'web.altText', 'Alt text input for PinImage by a human'),{pinTitle:M||Z}).join(""),O="",z,$=0,N=0;if(D.imageSpec_736x||D.imageSpec_orig||D.imageSpec_474x||D.imageSpec_236x){let e=D.imageSpec_236x;if(t)e=D.imageSpec_736x||D.imageSpec_orig||D.imageSpec_474x||D.imageSpec_236x;else{let{thumbnail:i,height:t,width:n}=H?.videoList?.vHLSV4||{};e=i?{url:i,height:t??1,width:n??1}:e}$=e?.height,N=e?.width,O=e?.url,z=t?e?.url?`${e.url} 1x`:"":[D.imageSpec_236x?.url&&`${D.imageSpec_236x.url} 1x`,D.imageSpec_474x?.url&&`${D.imageSpec_474x.url} 2x`,D.imageSpec_736x?.url&&`${D.imageSpec_736x.url} 3x`,D.imageSpec_orig?.url&&`${D.imageSpec_orig.url} 4x`].filter(Boolean).join(", ")}let G=(0,g.Z)({altText:j,autoAltText:K,i18n:w})||!!R?.trim().length&&R||B;if(E)return(0,k.jsx)(C.Z,{_fixCompletedOnLoad:S,highResOnly:t,isThirdPartyAd:A,onError:l,onLoad:r,pinKey:D});let U=["ShoppingGridSmall","ShoppingGridSmallCarousel"].includes(b)?void 0:x.Ml,Q=(0,F.Z)(b),q="non-story-pin-image";return(0,k.jsx)(u.kC,{alignItems:"center",justifyContent:"start",minHeight:U,children:(0,k.jsx)(u.xu,{flex:"grow",children:(0,k.jsx)("div",{className:p()({savedGradient:h}),children:D.storyPinDataId?(0,k.jsx)(L,{cropHeight:e,cropStoryPinImage:!!i&&(V.includes(b)||!!a),cropWidth:i,children:(0,k.jsx)(P,{_fixCompletedOnLoad:S,alt:G,fetchPriority:_?"low":void 0,onError:l,onLoad:r,pinKey:D})}):(0,k.jsx)(u.xu,{"data-test-id":q,height:i?e:void 0,width:i||void 0,children:(0,k.jsx)(m.Z,{_fixCompletedOnLoad:S,alt:G,color:"dominant"===Q?W??"":Q,crossOrigin:A?"anonymous":void 0,elementTiming:`grid-${q}-${b}`,fetchPriority:_?"low":void 0,fit:n,naturalHeight:$??1,naturalWidth:N??1,onError:l,onLoad:r,src:O??"",srcSet:z})})})})})};var j=t(453179),K=t(104659),E=t(539692),R=t(807340),W=t(605636);let Z={__style:{backgroundColor:"#000"}};function A({backgroundImage:e,naturalHeight:i,naturalWidth:t,onRestartVideo:n,pinId:a}){(0,d.useEffect)(()=>{(0,s.Z)("PinVideoEndCard","/app/www/AuthDesktopPinRep/PinVideoEndCard.tsx")},[]);let l=(0,f.Z)();return(0,k.jsxs)(u.Ee,{alt:l._('pin image', 'image of a pin', 'image of a pin'),naturalHeight:i,naturalWidth:t,src:e,children:[(0,k.jsx)(u.xu,{bottom:!0,dangerouslySetInlineStyle:Z,left:!0,opacity:.8,position:"absolute",right:!0,top:!0}),(0,k.jsxs)(u.xu,{"data-test-id":`video-end-card-${a}`,direction:"column",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%",children:[(0,k.jsx)(u.iP,{rounding:2,children:(0,k.jsxs)(u.xu,{display:"flex",justifyContent:"center",padding:2,children:[(0,k.jsx)(u.JO,{accessibilityLabel:l._('Visit site', 'Button when pressed goes to pin\'s website', 'Button when pressed goes to pin\'s website'),color:"light",dangerouslySetSvgPath:{__path:R.Z},size:25}),(0,k.jsx)(u.xu,{margin:1}),(0,k.jsx)(u.xv,{color:"light",lineClamp:1,weight:"bold",children:l._('Visit site', 'Button when pressed goes to pin\'s website', 'Button when pressed goes to pin\'s website')})]})}),(0,k.jsx)(u.xu,{margin:3}),(0,k.jsx)(u.iP,{onTap:n,rounding:2,children:(0,k.jsxs)(u.xu,{display:"flex",justifyContent:"center",padding:2,children:[(0,k.jsx)(u.JO,{accessibilityLabel:l._('Watch again', 'Button when pressed restarts the video', 'Button when pressed restarts the video'),color:"light",dangerouslySetSvgPath:{__path:W.Z},size:25}),(0,k.jsx)(u.xu,{margin:1}),(0,k.jsx)(u.xv,{color:"light",lineClamp:1,weight:"bold",children:l._('Watch again', 'Button when pressed restarts the video', 'Button when pressed restarts the video')})]})})]})]})}function M({aspectRatio:e,children:i}){return(0,d.useEffect)(()=>{(0,s.Z)("VideoAspectRatioWrapper","/app/www/video/VideoAspectRatioWrapper.tsx")},[]),(0,k.jsx)(u.xu,{dangerouslySetInlineStyle:{__style:{aspectRatio:e}},children:i})}var H=t(720445);let B=new Set(["ConversationView","TodayTabFeed"]),O=(void 0!==l||(l=t(751457)).hash&&"6700b53021feabf2b7b65f349edcf8b3"!==l.hash&&console.error("The definition of 'PinVideo_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function z({isAutoplay:e,cropHeight:i,currentTime:t,highResOnly:n,onLoad:a,onError:l,saved:r,onTimeChange:o,isExperimentalPinRep:c,pinKey:h,surface:p,playing:g,rootMargin:m,viewType:f,viewParameter:v,cropWidth:x,video:S}){let w,_;(0,d.useEffect)(()=>{(0,s.Z)("PinVideo","/app/common/react/components/PinRep/components/PinVisual/PinVideo.tsx")},[]);let[P,T]=(0,d.useState)(!1),[C,F]=(0,d.useState)(!g),V=(0,y.Z)(O,h),{checkExperiment:I}=(0,b.Z)(),{isDownstreamPromotion:L,promoter:R}=V,W=(0,j.jL)(!!L,!!R),Z=W&&!V.isEligibleForWebCloseup,z=c&&W&&V.isEligibleForWebCloseup&&!B.has(p),{setCurrentVideo:$}=(0,K.G)(),N=!!z&&I("ads_web_disable_video_end_card").anyEnabled;e&&g&&C&&F(!1);let{url:G}=V.imageSpec_236x??{},{entityId:U,isPromoted:Q}=V,q=(0,d.useCallback)(({event:e})=>{e.preventDefault(),e.stopPropagation(),$({pinId:U,isPromoted:!!Q,currentTime:0}),T(!1)},[Q,U,$]),J=(0,d.useCallback)(()=>{Q&&(N||T(z))},[Q,z,N]),Y=S??V.videos?.videoList?.vHLSV4;if(!Y)return null;let{height:X,thumbnail:ee,width:ei,url:et}=Y,en=S?.entityId??V.videos?.entityId??"",ea=(ei??1)/(X??1);if(void 0!==x&&void 0!==i&&null!==x&&null!==i){let e="string"==typeof x?parseFloat(x):x,t="string"==typeof i?parseFloat(i):i;Number.isFinite(e)&&Number.isFinite(t)&&e>0&&t>0&&(ea=e/t,_="cover")}let el=p&&(0,E.Z)(p)&&"UserProfilePinGrid"!==p;if(el&&(ea=1,w="transparent"),"VideoCarouselModule"===p&&(_="cover",ea=(x??ei??1)/(i??X??1)),P&&W)return(0,k.jsx)(u.xu,{children:(0,k.jsx)(A,{backgroundImage:G??"",naturalHeight:X??1,naturalWidth:ei??1,onRestartVideo:q,pinId:U})});let er={highResOnly:n,onError:l,onLoad:a,pinKey:V,saved:r};el&&(er={...er,cropHeight:i,cropWidth:x,imageFit:"contain"});let eo=(0,k.jsx)(u.xu,{"data-test-id":"pinrep-video--placeholder","data-test-image-signature":G,children:(0,k.jsx)(M,{aspectRatio:ea,children:(0,k.jsx)(D,{...er,ssrImpressionFixEnabled:!1,surface:p})})});return C?eo:(0,k.jsx)(u.xu,{children:(0,k.jsx)(H.ZP,{aspectRatio:ea,backgroundColor:w,captions:"",contextLogData:{viewParameter:v,component:0,objectId:U,video_id:en,view:f},fallback:eo,hlsConfig:{capLevelToPlayerSize:!0,startPosition:t||-1},isAutoPlay:!!e,loop:Z||!c||!W||N,objectFit:_,onEnded:J,onPlay:()=>{},onPlayError:()=>{},onTimeChange:o,playing:g,poster:G||ee||void 0,rootMargin:m,src:[{type:"video/m3u8",src:et}]??[],surface:p,videoStartTime:t,volume:0})})}var $=t(647709),N=t(776777),G=t(863667),U=t(750092);let Q=(void 0!==r||(r=t(46424)).hash&&"1348c39b7f31610be1c0d3768e3ee907"!==r.hash&&console.error("The definition of 'useAutoplayOrgVideoOnHover_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);var q=t(601405);function J(e,i,t){var n;return(i="symbol"==typeof(n=function(e,i){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,i||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}(i,"string"))?n:n+"")in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}let Y=(void 0!==o||(o=t(644073)).hash&&"ff86500434f78bdd6ea81969c1825eec"!==o.hash&&console.error("The definition of 'PinVideoWithVisibility_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);class X extends d.Component{constructor(...e){super(...e),J(this,"calculateCurrentVideoTime",()=>{let{currentTimeFromPinRep:e,pin:i,videosAutoplaying:t}=this.props,{entityId:n}=i,a=(0,G.Z)(n,t);return this.currentVideoCurrentTime||a||e}),J(this,"handleVisibilityChanged",(e,i)=>{let{currentTimeFromPinRep:t,pin:n,setCurrentVideo:a,pauseAutoplay:l,videosAutoplaying:r}=this.props,{entityId:o,isPromoted:s}=n,d=(0,U.Z)(o,r),u=function(e,i){let{organicVideosAutoplaying:t,promotedVideosAutoplaying:n}=i,a={...t,...n};for(let i in a){let{paused:t}=a[i];if(i!==e&&!t)return!1}return!0}(o,r);e?s?a({pinId:o,isPromoted:s,currentTime:this.calculateCurrentVideoTime()}):(u||"VideoCarouselModule"===i)&&a({pinId:o,isPromoted:!!s,currentTime:this.calculateCurrentVideoTime(),surface:i}):!e&&d&&l({pinId:o,isPromoted:!!s,currentTime:t||this.currentVideoCurrentTime,surface:i})}),J(this,"handleVideoTimeChange",e=>{let{pin:i,onTimeChange:t,videosAutoplaying:n}=this.props,{entityId:a}=i;(0,U.Z)(a,n)&&(this.currentVideoCurrentTime=e.time),t&&t(e)})}componentDidMount(){this.props.onLoad&&this.props.onLoad()}componentDidUpdate(e){let{appInFocus:i}=e,{appInFocus:t,currentTimeFromPinRep:n,pauseAutoplay:a,pin:l,setCurrentVideo:r,videosAutoplaying:o}=this.props,{entityId:s,isPromoted:d}=l,u=(0,U.Z)(s,o);t!==i&&!t&&u?(this.pausedDueToBrowserOutOfFocus=!0,a({pinId:s,isPromoted:!!d,currentTime:n||this.currentVideoCurrentTime})):this.pausedDueToBrowserOutOfFocus&&t&&(this.pausedDueToBrowserOutOfFocus=!1,r({pinId:s,isPromoted:!!d,currentTime:this.calculateCurrentVideoTime()}))}componentWillUnmount(){let{currentTimeFromPinRep:e,pauseAutoplay:i,pin:t,videosAutoplaying:n}=this.props,{entityId:a,isPromoted:l}=t;(0,U.Z)(a,n)&&i({pinId:a,isPromoted:!!l,currentTime:e||this.currentVideoCurrentTime})}render(){let{cropHeight:e,isAutoplay:i,pin:t,surface:n,videosAutoplaying:a,viewParameter:l,viewType:r,highResOnly:o,onError:s,onLoad:d,saved:u,isExperimentalPinRep:c,rootMargin:h,cropWidth:p,video:g}=this.props,{entityId:m}=t,y=(0,G.Z)(m,a),f=(0,U.Z)(m,a),v={cropHeight:e,rootMargin:h,currentTime:y,isAutoplay:i,viewParameter:l,viewType:r,onTimeChange:this.handleVideoTimeChange,onVisibilityChanged:e=>this.handleVisibilityChanged(e,n),pinKey:t,surface:n,playing:f&&i,trackFullVisible:!1,highResOnly:o,onError:s,onLoad:d,saved:u,isExperimentalPinRep:c,cropWidth:p,...g?{video:g}:{}};return(0,k.jsx)(N.Z,{onVisibilityChanged:e=>this.handleVisibilityChanged(e,n),rootMargin:h,trackFullVisible:v.trackFullVisible,children:(0,k.jsx)(z,{...v})})}}function ee({pinKey:e,isHovering:i=!1,...t}){(0,d.useEffect)(()=>{(0,s.Z)("PinVideoWithVisibility","/app/common/react/components/PinRep/components/PinVisual/PinVideoWithVisibility.tsx")},[]);let{appUI:{appInFocus:n,isAutoplay:a,videosAutoplaying:l},pauseAutoplay:r,setCurrentVideo:o}=(0,K.G)(),u=(0,y.Z)(Y,e),c=(0,$.HG)(),h=(0,q.Z)({isDesktop:c}),p=(0,q.z)({isMetricVideoExperimentEnabled:h,isDesktop:c}),g=(0,d.useRef)(i);return!function({pinKey:e,isHovering:i,hoverState:t,disabled:n=!1}){let a=(0,y.Z)(Q,e),{setCurrentVideo:l,pauseAutoplay:r,appUI:{videosAutoplaying:o}}=(0,K.G)(),s=a?.videos?.videoList?.v720P||a?.videos?.videoList?.vHLSV4||a?.videos?.videoList?.vHLSV3MOBILE;(0,d.useEffect)(()=>{if(a&&!n){if(t.current!==i){let{entityId:e,isPromoted:t,storyPinData:n}=a,d=(0,G.Z)(e,o);if(s||n?.totalVideoDuration)if(i){let i=function(e,i){let{currentlyPlayingOrganicVideoId:t,organicVideosAutoplaying:n}=i;return t&&t!==e?t:Object.keys(n).find(e=>!1===n[e].paused)}(e,o);i&&r({currentTime:d,pinId:i,isPromoted:!1}),l({currentTime:d,pinId:e,isPromoted:!!t})}else t||r({currentTime:d,pinId:e,isPromoted:!!t})}t.current=i}},[i,t,r,a,l,s,o,n])}({pinKey:u,isHovering:i,hoverState:g,disabled:p}),(0,k.jsx)(X,{...t,appInFocus:n,isAutoplay:a,pauseAutoplay:r,pin:u,setCurrentVideo:o,videosAutoplaying:l})}},289032:function(e,i,t){t.d(i,{Z:()=>n});function n(e,i,t){let n,a,l,r=!!t?.leading,o=t?.trailing!==!1,s=t?.maxWait?Math.max(t.maxWait,i):void 0,d=null,u=0;function c(i){let t=n;return n=void 0,u=i,t&&(a=e(...t)),a}function h(e){let t=e-(l??0),n=e-u;return void 0===l||t>=i||t<0||void 0!==s&&n>=s}function p(){let e=Date.now();h(e)?(d=null,o&&n)?c(e):n=void 0:d=setTimeout(p,function(e){let t=e-(l??0),n=e-u,a=i-t;return void 0!==s?Math.min(a,s-n):a}(e))}function g(){null!==d&&clearTimeout(d),d=setTimeout(p,i)}function m(...e){let t=Date.now(),o=h(t);if(n=e,l=t,o){if(null===d)return u=t,d=setTimeout(p,i),r?c(t):a;else if(void 0!==s)return g(),c(t)}return null===d&&g(),a}return m.flush=function(){if(null!==d&&n){let e=Date.now();return clearTimeout(d),d=null,c(e)}return a},m.cancel=function(){null!==d&&clearTimeout(d),u=0,n=void 0,l=void 0,d=null},m}},807340:function(e,i,t){t.d(i,{Z:()=>n});let n="M17.496 14.572a1 1 0 0 1-1 1h-.001a1.001 1.001 0 0 1-.999-1.001l.002-4.652-7.29 7.288a.995.995 0 0 1-.707.293.999.999 0 0 1-.707-1.707l7.293-7.29L9.428 8.5a1 1 0 0 1 .001-2h.001l8.071.005-.005 8.067zM12 0C5.373 0 0 5.373 0 12c0 6.628 5.373 12 12 12 6.628 0 12-5.372 12-12 0-6.627-5.372-12-12-12z"},605636:function(e,i,t){t.d(i,{Z:()=>n});let n="M12 18.5A6.508 6.508 0 0 1 5.5 12c0-1.706.689-3.307 1.835-4.5H6.5a1 1 0 1 1 0-2h4.185v4.474a1 1 0 0 1-2 0V8.972A4.505 4.505 0 0 0 7.5 12c0 2.481 2.019 4.5 4.5 4.5s4.5-2.019 4.5-4.5a4.49 4.49 0 0 0-3.112-4.283 1 1 0 1 1 .615-1.902A6.482 6.482 0 0 1 18.5 12c0 3.584-2.916 6.5-6.5 6.5M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0"},776777:function(e,i,t){t.d(i,{Z:()=>s});var n=t(281098),a=t(667294),l=t(20256),r=t(331854),o=t(785893);function s({onVisibilityChanged:e,children:i,...t}){(0,a.useEffect)(()=>{(0,n.Z)("VisibilityChangedWrapper","/app/packages/useVisibilityChanged/VisibilityChangedWrapper.tsx")},[]);let s=(0,r.Z)({onVisibilityChanged:e,...t});return(0,o.jsx)(l.xu,{ref:s,children:i})}},863667:function(e,i,t){t.d(i,{Z:()=>n});function n(e,i){let{organicVideosAutoplaying:t,promotedVideosAutoplaying:n,videoCarouselModuleAutoplaying:a}=i,l={...t,...n,...a};return l[e]&&l[e].currentTime}},97365:function(e,i,t){t.d(i,{Z:()=>n});let n={debugPinImpressions:999,max:9999,pinActionWrapper:101,saved:102,storyPinImage:-1}},688170:function(e,i,t){t.d(i,{C:()=>n,_:()=>a});let n=e=>!!e&&/^\/pin\/[\w-]+\/?$/.test(e.pathname),a=e=>{let i=[...e].reverse().find(({location:e})=>e&&!n(e));return i&&i.location&&(({pathname:e})=>/^\/search\/pins\//.test(e))(i.location)?(({pathname:e,search:i})=>{let t=/^\/search\/pins\/(\?.*)$/.exec(e),n=(i||t&&t[1]||"").substr(1).split("&").map(e=>e.split("=")).find(e=>"q"===e[0]);return n?decodeURIComponent(n[1]):""})(i.location):""}},778058:function(e,i,t){t.d(i,{Z:()=>b});var n,a=t(281098),l=t(667294);t(422578);var r=t(20256),o=t(582569),s=t(28427),d=t(93966),u=t(19585),c=t(97484),h=t(675973),p=t(15667),g=t(712172),m=t(547585),y=t(785893);function f(e,i,t){var n;return(i="symbol"==typeof(n=function(e,i){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,i||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}(i,"string"))?n:n+"")in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}let v=(void 0!==n||(n=t(379026)).hash&&"95793e1276a19bfa11c2fd12c81bc9af"!==n.hash&&console.error("The definition of 'DeprecatedCarousel_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);class x extends l.Component{constructor(...e){super(...e),f(this,"state",{showBadge:!0,startImpressionTimer:!1}),f(this,"renderBadge",()=>{let{carouselData:e,isCloseup:i,showCarouselBadge:t}=this.props;if(!e)return null;let{showBadge:n}=this.state,{carouselSlots:a,index:l}=e;return!i&&t?(0,y.jsx)(r.xu,{alignItems:"center",color:"selected",dangerouslySetInlineStyle:{__style:{opacity:.8*!!n,transition:"opacity .3s"}},"data-test-id":"carousel-badge",display:"flex",height:35,justifyContent:"center",marginEnd:5,marginTop:5,position:"absolute",right:!0,rounding:2,width:35,zIndex:new r.Ry(1),children:(0,y.jsx)(r.xv,{color:"inverse",children:`${(l??0)+1}/${(a??[]).length}`})}):null}),f(this,"onLoadImage",()=>{this.setState({startImpressionTimer:!0}),this.props.onLoad?.()}),f(this,"onImageLoadError",()=>{this.setState({startImpressionTimer:!1}),this.props.onError?.()})}componentDidMount(){(0,a.Z)("DeprecatedCarousel","/app/www/common/Carousel/DeprecatedCarousel.tsx"),this.hideBadgeTimeout=setTimeout(()=>this.setState({showBadge:!1}),3e3)}componentDidUpdate(e){let{showBadge:i}=this.state,{carouselData:t}=e,{carouselData:n}=this.props;if(!t||!n)return;let{index:a}=t,{index:l}=n;i&&(this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout),this.hideBadgeTimeout=setTimeout(()=>this.setState({showBadge:!1}),3e3)),a!==l&&(this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout),this.setState({showBadge:!0}))}componentWillUnmount(){this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout)}render(){let e,{isCloseup:i,carouselIndex:t,closeupHeight:n,closeupWidth:a=0,widthRatio:l=1,cropHeight:o,cropWidth:s,carouselData:u,disableTransition:h,highResOnly:p,pinId:f,imageSignature:v,isEditMode:x,isDenseView:b,isThirdPartyAd:S,_fixCompletedOnLoad:k}=this.props;if(!u)return null;if(l>1||l<0)throw Error("widthRatio should be between 0 and 1 inclusive");let{carouselSlots:w}=u,_=u.index??0,P=void 0!==t?t:_??0,{imageSizeMap:T}=w[P]||{},C=Math.floor((e=i?a:!i&&s||(p?474:b?d.Lo:d.yF))*l),F=T?.["236x"]||{},V=o||F.height||0,I=s||F.width||236,L=n||V/I*C,D=(e=>{let i=e.reduce((e,i)=>{let{imageSizeMap:t}=i,{height:n,width:a}=t?.["736x"]||t?.["236x"]||{},l=`${a??1}x${n??1}`,r=e[l]?.times||0;return{...e,[l]:{imageHeight:n,imageWidth:a,times:r+1}}},{}),t=Object.keys(i).reduce((e,t)=>i[t].times>e.times?i[t]:e,{times:-1,imageHeight:-1,imageWidth:-1});return Object.keys(i).length>1?{imageHeight:t.imageHeight,imageWidth:t.imageWidth}:null})(w);return(0,y.jsxs)(r.xu,{alignItems:"center","data-test-id":"carousel-pin","data-test-image-signature":v,display:"flex",height:L,minHeight:c.Ml,overflow:"hidden",children:[!x&&this.renderBadge(),(0,y.jsx)(m.JE,{carouselData:{...u,type:"canonical"},impressionType:"Pin",isPaused:!this.state.startImpressionTimer,loggingId:f,slotIndex:_??0,viewParameter:72,viewType:1,children:({impressionTrackerRef:e})=>(0,y.jsx)(r.xu,{ref:e,"data-test-id":`carousel-impression-ref-${f}-${_}`,height:L,overflow:"hidden",position:"absolute",width:C})},`carousel-impression-key-${P}`),(0,y.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{transition:h?"":"left .3s",left:(0,g.vF)(w.length,C,e,P)}},direction:"row",display:"flex",height:"100%",left:!0,position:"relative",width:C*w.length,children:w.map((t,n)=>{if(i){let i=n===w.length-1;return(({pinId:e,slot:i,slotIndex:t,onError:n,onLoad:a,widthToUse:l,gap:o},s)=>{let{url:d,width:u,height:c}=["564x","736x","474x","236x"].map(e=>i.imageSizeMap?.[e]).find(e=>e?.url)||{},{details:h=""}=i,p=(0,g.GH)(h,s,t);return(0,y.jsx)(r.xu,{"data-test-id":"carousel-slot-container",height:"100%",marginEnd:o,width:l,children:(0,y.jsx)(r.zd,{height:"100%",wash:!0,children:d&&(0,y.jsx)(r.Ee,{alt:p,fit:"contain",naturalHeight:c??1,naturalWidth:u??1,onError:n,onLoad:a,src:d})})},`carousel-slot-${e}-${t}`)})({pinId:f,slot:t,slotIndex:n,onError:this.onImageLoadError,onLoad:this.onLoadImage,widthToUse:C,gap:+(C<e&&!i)},this.props.i18n)}return((e,i,t,n,a,l,o,s,d,u,c,h,p,m,f,v)=>{let x,{imageSizeMap:b,details:S=""}=t,k=236,w=236,_="";l?(k=474,w=b&&Math.min(k/.8,k/((b["564x"]?.width??1)/(b["564x"]?.height??1))),_=b&&b["564x"]?.url):b&&b["736x"]?(w=b&&b["736x"]&&b["736x"].height,k=b&&b["736x"]&&b["736x"].width,_=b&&b["736x"]&&b["736x"].url):b&&b["236x"]&&(w=b&&b["236x"]&&b["236x"].height,k=b&&b["236x"]&&b["236x"].width,_=b&&b["236x"]&&b["236x"].url),p&&m&&(w=Math.min(p*m,w??1)),x=l?`${b?.["564x"]?.url??""} 1x`:[b?.["474x"]&&`${b["474x"].url??""} 2x`,b?.["736x"]&&`${b["736x"].url??""} 3x`,b?.orig&&`${b.orig.url??""} 4x`].filter(Boolean).join(", ");let P=(0,g.GH)(S,i,a),T=h?void 0:w,C=h?void 0:k,{boxHeight:F,boxWidth:V}=f?{boxHeight:f?.imageHeight,boxWidth:f?.imageWidth}:{boxHeight:T,boxWidth:C};return(0,y.jsx)(r.xu,{"data-test-id":"carousel-slot-container",height:F??void 0,width:V??void 0,children:(0,y.jsx)(r.xu,{"data-test-id":`carousel-img-${a}`,height:h?c:void 0,width:h||void 0,children:_&&(0,y.jsx)(r.Ee,{_fixCompletedOnLoad:e,alt:P,crossOrigin:v?"anonymous":void 0,fit:h?"cover":"none",naturalHeight:w??1,naturalWidth:k??1,onError:o,onLoad:s,src:_,srcSet:x})})},`carousel-slot-${n}-${a}`)})(k,this.props.i18n,t,f,n,p,this.onImageLoadError,this.onLoadImage,0,0,o,s,L,C,D,S)})})]})}}function b({pinKey:e,...i}){(0,l.useEffect)(()=>{(0,a.Z)("DeprecatedCarousel","/app/www/common/Carousel/DeprecatedCarousel.tsx")},[]);let t=(0,u.Z)(),{checkExperiment:n}=(0,h.Z)(),{isAuthenticated:r}=(0,p.B)(),d=(0,s.Z)(v,e),c=(0,o.Z)(d),g=c&&{...c,carouselSlots:function(e){let i=["236x","474x","564x","736x"].map(i=>{let t=Math.min(...e.map(e=>e.imageSizeMap?.[i]?.height||1/0)),n=Math.min(...e.map(e=>e.imageSizeMap?.[i]?.width||1/0));return{imageKey:i,height:t,width:n}});return e.map(e=>i.reduce((e,{imageKey:i,height:t,width:n})=>({...e,imageSizeMap:{...e.imageSizeMap,...e.imageSizeMap?.[i]?{[i]:{...e.imageSizeMap[i],height:t,width:n}}:{}}}),e))}(c.carouselSlots)};return(0,y.jsx)(x,{...i,carouselData:g,checkExperiment:n,i18n:t,imageSignature:d.imageSignature,isAuthenticated:r,pinId:d.entityId})}f(x,"defaultProps",{showCarouselBadge:!0})},720445:function(e,i,t){t.d(i,{ZP:()=>F});var n,a=t(281098),l=t(667294);t(422578);var r=t(20256),o=t(980787),s=t(289032),d=t(28427),u=t(115247),c=t(675973),h=t(15667),p=t(149026),g=t(792171),m=t(589357),y=t(78762),f=t(785893);function v(e,i,t){var n;return(i="symbol"==typeof(n=function(e,i){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,i||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}(i,"string"))?n:n+"")in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}let x=(0,y.Z)(()=>Promise.all([t.e("25418"),t.e("22244"),t.e("31142")]).then(t.bind(t,509691)),void 0,e=>509691,"app-www-video-VideoWrapper",e=>["25418","22244","31142"]),b=[0,.25,.5,.75,.95,.97],S=[0,.5,.8,.99,1],k={rootMargin:"-64px 0px 0px 0px",threshold:[...m.iM]},w=Object.freeze({LOADING:0,PLAYING:1,PAUSED:2,STALLING:3}),_=(void 0!==n||(n=t(454387)).hash&&"93ed23334d5bac81ac8410f05c4f2031"!==n.hash&&console.error("The definition of 'VideoWithContextLogging_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function P(){return new Date().getTime()}function T(e){return!!e.volume&&e.volume>0}class C extends l.Component{constructor(e){super(e),v(this,"videoWrapperRef",(0,l.createRef)()),v(this,"loggedQuartiles",new Set),v(this,"handleWindowResize",()=>{if(!this.fullscreen){let e=this.getDimensions(),{height:i,width:t}=this.currentInterval;e.height!==i||e.width!==t?this.startNewInterval(e):(this.currentInterval.windowHeight=e.windowHeight,this.currentInterval.windowWidth=e.windowWidth)}}),v(this,"handlePlayheadDown",({event:e})=>{let{onPlayheadDown:i}=this.props;this.setState({seeking:!0}),i&&i({event:e})}),v(this,"handlePlayheadUp",({event:e})=>{let{onPlayheadUp:i}=this.props;this.setState({seeking:!1}),i&&i({event:e})}),v(this,"handleLoop",()=>{this.videoTime=0}),v(this,"handlePlaying",e=>{this.logVideoStart(),this.props.onPlaying&&this.props.onPlaying(e)}),v(this,"handleTimeChange",e=>{let{seeking:i,ready:t}=this.state;if(!this.currentInterval.videoDuration)return;let n=1e3*e.time,a=function(e,i,t,n){if(e>i||t<=0)return null;for(let a of n){let n=a*t;if(e<=n&&i>n)return a}return null}(this.videoTime,n,this.currentInterval.videoDuration,b);if("number"==typeof a&&this.props.playing&&!i&&t){let e=P(),{isQuartileDeduplicationEnabled:i}=this.props;i&&this.loggedQuartiles.has(a)||(this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:Math.floor(4*a),quartilePercentValue:a}),i&&this.loggedQuartiles.add(a))}this.videoTime=n,this.props.onTimeChange&&this.props.onTimeChange(e)}),v(this,"handleDurationChange",e=>{this.currentInterval.videoDuration=1e3*e.duration,this.props.onDurationChange&&this.props.onDurationChange(e)}),v(this,"handleReady",e=>{let{ready:i}=this.state;i||this.setState({ready:!0}),this.props.onReady&&this.props.onReady(e)}),v(this,"handleEnded",e=>{this.logFourthQuartileEvent(),this.props.loop&&(this.startNewInterval(),this.currentInterval.videoStartTime=0),this.props.onEnded&&this.props.onEnded(e)}),v(this,"handleVisibilityChange",e=>{if(0===e.length)return;let i=function(e){for(let i=0;i<S.length;i+=1){let t=S[i],n=S[i+1];if(null==n||t<=e&&e<n)return t}return null}(Number.parseFloat(e.slice(-1)[0].intersectionRatio.toFixed(2)));"number"==typeof i&&(this.visible=i>=.5),null==i||i===this.currentInterval.viewability||this.fullscreen||(0===i?this.startNewInterval({viewability:i,playbackState:w.PAUSED}):this.startNewInterval({viewability:i}))}),v(this,"handleFullscreenChange",({event:e,fullscreen:i})=>{if(i){let{height:e,width:i}=window.screen;this.startNewInterval({height:e,width:i,windowHeight:e,windowWidth:i})}else i||this.startNewInterval(this.getDimensions());this.fullscreen=i,this.props.onFullscreenChange&&this.props.onFullscreenChange({event:e,fullscreen:i})}),v(this,"handleClose",()=>{this.startNewInterval()}),this.state={ready:!1,seeking:!1,started:!1};let i=P();this.handleWindowResize=(0,s.Z)(this.handleWindowResize,1e3),this.currentInterval={videoDuration:0,startTime:i,endTime:i,videoStartTime:0,videoEndTime:0,isAudible:T(e),playbackState:this.getPlaybackState(e,this.state),quartile:-1,quartilePercentValue:0,height:null,width:null,windowHeight:null,windowWidth:null,viewability:null},this.videoTime=0,this.fullscreen=!1,this.visible=null}componentDidMount(){(0,a.Z)("VideoWithContextLogging","/app/www/video/VideoWithContextLogging.tsx"),this.currentInterval={...this.currentInterval,...this.getDimensions()},window.addEventListener("resize",this.handleWindowResize),window.addEventListener("beforeunload",this.handleClose)}componentDidUpdate(e,i){let t={};T(e)&&!T(this.props)?t.isAudible=!1:!T(e)&&T(this.props)&&(t.isAudible=!0);let n=this.getPlaybackState(this.props,this.state);this.getPlaybackState(e,i)!==n&&(t.playbackState=n),Object.keys(t).length>0&&this.startNewInterval(t)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("beforeunload",this.handleClose),this.startNewInterval()}getPlaybackState(e,i){return i.ready?e.playing&&!i.seeking?w.PLAYING:w.PAUSED:w.LOADING}getDimensions(){let e,i;if(this.videoWrapperRef.current){let t=this.videoWrapperRef.current;t.clientHeight&&t.clientWidth&&(e=t.clientHeight,i=t.clientWidth)}return{height:e,width:i,windowHeight:window.innerHeight,windowWidth:window.innerWidth}}logVideoEvent(e,i){let{closeupStoryPinViewability:t,contextLogData:n,logContextEvent:a,playing:l,surface:r}=this.props,{seeking:o}=this.state,{height:s,width:d,windowHeight:u,windowWidth:c,viewability:h,...p}=i;if(null!=s&&null!=d&&null!=u&&null!=c&&null!=h){let i={...p,gridAutoplay:6904===e&&l&&!o&&("AuthHomefeed"===r||"SearchItem"===r||"RelatedPinGrid"===r||"PdpRelatedPinGrid"===r),height:s,width:d,windowHeight:u,windowWidth:c,viewability:t||h};a({event_type:e,...function(e){let{eventData:{videoEvent:{gridAutoplay:i,videoDuration:t,startTime:n,endTime:a,videoStartTime:l,videoEndTime:r,isAudible:o,height:s,width:d,playbackState:u,quartile:c,quartilePercentValue:h,windowHeight:p,windowWidth:g,viewability:m}},component:y,objectId:f,view:v,viewParameter:x,...b}=e;return{component:y,object_id_str:f,view_type:v,view_parameter:x,aux_data:{...b},event_data:{videoEventData:{gridAutoplay:i,videoDuration:t?Math.floor(t):0,time:n,endTime:a,videoTime:l?Math.floor(l):0,endVideoTime:r?Math.floor(r):0,isAudible:o,height:s,width:d,playbackState:u,quartile:c,quartilePercentValue:h,windowHeight:p,windowWidth:g,viewability:m}}}}({...n,view:this.fullscreen?108:n.view,eventData:{videoEvent:i}})})}}logFourthQuartileEvent(){let{isQuartileDeduplicationEnabled:e}=this.props;if(!e||!this.loggedQuartiles.has(1)){let i=P();this.logVideoEvent(6906,{...this.currentInterval,startTime:i,endTime:i,videoStartTime:0,videoEndTime:0,quartile:4,quartilePercentValue:1}),e&&this.loggedQuartiles.add(1)}}logVideoStart(){if(this.state.started)return;let{contextLogData:e,setVideoPlayed:i}=this.props;i(e.objectId),this.setState({started:!0})}startNewInterval(e){let i=P();this.logVideoEvent(6904,{...this.currentInterval,endTime:i,videoEndTime:this.videoTime}),this.currentInterval={...this.currentInterval,...e,startTime:i,videoStartTime:this.videoTime,endTime:-1,videoEndTime:-1}}render(){let{rootMargin:e,surface:i,aspectRatio:t,backgroundColor:n,captions:a,contextLogData:l,controls:o,fallback:s,hlsConfig:d,isAutoPlay:c,loop:h,objectFit:g,onLoadedChange:m,onControlsPause:y,onControlsPlay:v,onSeek:b,onVolumeChange:S,pin:w,playbackRate:_,playing:P,playsInline:T,poster:C,preload:F,seekTime:V,src:I,videoStartTime:L,volume:D,video:j,variant:K,setVideoRef:E}=this.props,{seeking:R}=this.state;return void 0!==e&&(k.rootMargin=i?(0,p.e)(i):e),(0,f.jsx)(u.Z,{onVisibilityChange:this.handleVisibilityChange,options:k,children:e=>(0,f.jsx)(r.xu,{ref:i=>{e.current=i,this.videoWrapperRef.current=i},height:"inherit",children:(0,f.jsx)(x,{aspectRatio:t,backgroundColor:n,captions:a,contextLogData:l,controls:o,fallback:s,hlsConfig:d,isAutoPlay:c,loop:h,objectFit:g,onControlsPause:y,onControlsPlay:v,onDurationChange:this.handleDurationChange,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onLoadedChange:m,onLoop:this.handleLoop,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onPlaying:this.handlePlaying,onReady:this.handleReady,onSeek:b,onTimeChange:this.handleTimeChange,onVolumeChange:S,pinKey:w,playbackRate:_,playing:!R&&P,playsInline:T,poster:C,preload:F,seekTime:V,setVideoRef:E,src:I,variant:K,video:j,videoStartTime:L,visible:this.visible,volume:D})})})}}function F(e){(0,l.useEffect)(()=>{(0,a.Z)("VideoWithContextLogging","/app/www/video/VideoWithContextLogging.tsx")},[]);let{pinKey:i}=e,t=(0,d.Z)(_,i),{logContextEvent:n}=(0,o.u)(),{setVideoPlayed:r}=(0,g.H)(),s=(0,h.B)(),{checkExperiment:u}=(0,c.Z)(),p=u("web_metrics_video_quartile_deduplication").anyEnabled;return(0,f.jsx)(C,{...e,isQuartileDeduplicationEnabled:p,logContextEvent:n,pin:t,requestContext:s,setVideoPlayed:r})}v(C,"defaultProps",r.nk.defaultProps)},589357:function(e,i,t){t.d(i,{Ul:()=>l,VS:()=>n,hy:()=>r,iM:()=>a,j4:()=>o});let n=2,a=[0,.01,.02,.03,.04,.05,.06,.07,.08,.09,.1,.11,.12,.13,.14,.15,.16,.17,.18,.19,.2,.21,.22,.23,.24,.25,.26,.27,.28,.29,.3,.31,.32,.33,.34,.35,.36,.37,.38,.39,.4,.41,.42,.43,.44,.45,.46,.47,.48,.49,.5,.51,.52,.53,.54,.55,.56,.57,.58,.59,.6,.61,.62,.63,.64,.65,.66,.67,.68,.69,.7,.71,.72,.73,.74,.75,.76,.77,.78,.79,.8,.81,.82,.83,.84,.85,.86,.87,.88,.89,.9,.91,.92,.93,.94,.95,.96,.97,.98,.99,1],l={backgroundImage:"linear-gradient(to top, rgba(0, 0, 0, .4), rgba(0, 0, 0, 0))",pointerEvents:"none",bottom:0},r=128,o=e=>e&&document.querySelector(`video[poster="${e}"]`)||null}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/83477-0e1156a99151ddef.mjs.map