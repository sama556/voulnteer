<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مجتمع التطوع - منصة التطوع السعودية</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/commntiy.css">
   
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="fas fa-hands-helping me-2"></i>منصة صوت التطوع 
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link " href="index.html">الرئيسية</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html#volunteers">المتطوعون</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="initiatives.html">المبادرات</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="platforms.html">المنصات الداعمة</a>
                    </li>
                  
                    <li class="nav-item">
                        <a class="nav-link active" href="community.html">مجتمع التطوع</a>
                    </li>
                </ul>
                <div class="d-flex flex-column flex-sm-row gap-2">
                    <div class="dropdown">
                        <button class="btn btn-outline-custom dropdown-toggle" type="button" id="userMenuDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user me-2"></i>حسابي
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenuDropdown">
                            <li>
                                <a class="dropdown-item" href="volunteer-profile.html">
                                    <i class="fas fa-user-circle me-2"></i>الملف الشخصي
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item" href="../login.html">
                                    <i class="fas fa-sign-out-alt me-2"></i>تسجيل الخروج
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section (matching initiatives.html style) -->
    <section class="py-5" style="padding-top: 140px !important; background: linear-gradient(135deg, #003B73 0%, #005EA6 50%, #008ECC 100%); color: white;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8 text-center" data-aos="fade-up" data-aos-duration="1000">
                    <h1 class="display-4 fw-bold mb-4">مجتمع التطوع</h1>
                    <p class="lead mb-4">اكتشف قصص المتطوعين الملهمة، شاهد تجاربهم، وشارك في رحلة العطاء والإنسانية</p>
                    <div class="d-flex flex-column flex-sm-row justify-content-center gap-3">
                        <a href="#stories" class="btn btn-light text-primary fw-semibold">
                            استكشف القصص
                        </a>
                        <button class="btn btn-outline-light fw-semibold" data-bs-toggle="modal" data-bs-target="#addStoryModal">
                            <i class="fas fa-plus me-2"></i>إضافة قصة جديدة
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Filter Section -->
    <section class="filter-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10" data-aos="fade-up" data-aos-duration="1000">
                    <div class="filter-box">
                        <h3 class="text-center mb-4">تصفح المحتوى</h3>
                        <div class="row g-3">
                            <div class="col-md-5">
                                <select class="form-select" id="categoryFilter">
                                    <option value="">جميع الفئات</option>
                                    <option value="education">التعليم</option>
                                    <option value="health">الصحة</option>
                                    <option value="environment">البيئة</option>
                                    <option value="relief">الإغاثة</option>
                                </select>
                            </div>
                            
                            <div class="col-md-5">
                                <select class="form-select" id="regionFilter">
                                    <option value="">جميع المناطق</option>
                                    <option value="riyadh">الرياض</option>
                                    <option value="jeddah">جدة</option>
                                    <option value="dammam">الدمام</option>
                                    <option value="makkah">مكة المكرمة</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-primary-custom w-100" onclick="applyFilters()">
                                    <i class="fas fa-search me-2"></i>بحث
                                </button>
                            </div>
                           
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Stories Section -->
    <section id="stories" class="py-5">
        <div class="container">
            <div class="section-header" data-aos="fade-up" data-aos-duration="1000">
                <h2>قصص وتجارب المتطوعين</h2>
                <p class="text-muted">اقرأ عن تجارب المتطوعين الملهمة في مجتمعنا</p>
            </div>
            
         
            <!-- Stories Grid -->
            <div class="row g-4">
                <div class="col-12 col-sm-6 col-lg-6 col-xl-4" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="100">
                    <div class="story-card h-100">
                        <div class="story-media">
                            <img src="images/4dd0f026e751148098e7004eae353068.jpg" class="img-fluid" alt="قصة تطوعية">
                            <div class="media-overlay">
                                <div class="media-type">
                                    <i class="fas fa-image"></i>
                                </div>
                            </div>
                        </div>
                        <div class="story-content">
                            <div class="story-meta">
                                <span class="badge badge-custom">تعليم</span>
                                <span class="story-date">منذ أسبوع</span>
                            </div>
                            <h5 class="story-title">تجربتي في تعليم الكبار</h5>
                            <p class="story-excerpt">كيف ساعدت في تعليم الكبار القراءة والكتابة في مجتمعي المحلي</p>
                            <div class="story-author">
                                <img src="images/man1.jpg" class="author-avatar" alt="المؤلف">
                                <div class="author-info">
                                    <h6>أحمد محمد</h6>
                                    <small>متطوع منذ 2021</small>
                                </div>
                            </div>
                            <div class="story-stats">
                                <span class="like-btn" data-story-id="1" onclick="event.stopPropagation(); toggleLike(this);">
                                    <i class="far fa-heart text-danger"></i> <span class="like-count">89</span>
                                </span>
                            </div>
                            <div class="story-actions d-flex gap-2 mt-2">
                                <button class="btn btn-outline-primary flex-fill" onclick="event.stopPropagation(); window.location.href='story.html';">عرض التفاصيل</button>
                                <div class="story-owner-actions" data-owner="ahmed" style="display: none;">
                                    <button class="btn btn-outline-warning btn-sm" onclick="event.stopPropagation(); editStory(1);" title="تعديل">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="event.stopPropagation(); deleteStory(1);" title="حذف">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-sm-6 col-lg-6 col-xl-4" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="200">
                    <div class="story-card h-100">
                        <div class="story-media">
                            <video class="img-fluid" poster="images/fe5f8099c3041cec30afe8ed0d2df5e3.jpg">
                                <source src="videos/volunteer-story1.mp4" type="video/mp4">
                            </video>
                            <div class="media-overlay">
                                <div class="media-type">
                                    <i class="fas fa-play"></i>
                                </div>
                            </div>
                        </div>
                        <div class="story-content">
                            <div class="story-meta">
                                <span class="badge badge-custom">صحة</span>
                                <span class="story-date">منذ 5 أيام</span>
                            </div>
                            <h5 class="story-title">رحلة العطاء في المجال الصحي</h5>
                            <p class="story-excerpt">فيديو يوثق تجربة متطوعة في تقديم الخدمات الصحية للمجتمع</p>
                            <div class="story-author">
                                <img src="images/woman5.jpg" class="author-avatar" alt="المؤلف">
                                <div class="author-info">
                                    <h6>نورة عبدالله</h6>
                                    <small>متطوعة منذ 2019</small>
                                </div>
                            </div>
                            <div class="story-stats">
                                <span class="like-btn" data-story-id="2" onclick="event.stopPropagation(); toggleLike(this);">
                                    <i class="far fa-heart text-danger"></i> <span class="like-count">156</span>
                                </span>
                            </div>
                            <div class="story-actions d-flex gap-2 mt-2">
                                <button class="btn btn-outline-primary flex-fill" onclick="event.stopPropagation(); window.location.href='story.html';">عرض التفاصيل</button>
                                <div class="story-owner-actions" data-owner="nora" style="display: none;">
                                    <button class="btn btn-outline-warning btn-sm" onclick="event.stopPropagation(); editStory(2);" title="تعديل">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="event.stopPropagation(); deleteStory(2);" title="حذف">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-sm-6 col-lg-6 col-xl-4" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="300">
                    <div class="story-card h-100">
                        <div class="story-media">
                            <img src="images/736cb88a471f0ac9354ace1886ebab18.jpg" class="img-fluid" alt="قصة تطوعية">
                            <div class="media-overlay">
                                <div class="media-type">
                                    <i class="fas fa-image"></i>
                                </div>
                            </div>
                        </div>
                        <div class="story-content">
                            <div class="story-meta">
                                <span class="badge badge-custom">بيئة</span>
                                <span class="story-date">منذ 10 أيام</span>
                            </div>
                            <h5 class="story-title">حملة تنظيف الشواطئ</h5>
                            <p class="story-excerpt">مشاركة في حملة تنظيف شواطئ جدة وحماية البيئة البحرية</p>
                            <div class="story-author">
                                <img src="images/man2.jpg" class="author-avatar" alt="المؤلف">
                                <div class="author-info">
                                    <h6>خالد سعيد</h6>
                                    <small>متطوع منذ 2020</small>
                                </div>
                            </div>
                            <div class="story-stats">
                                <span class="like-btn" data-story-id="3" onclick="event.stopPropagation(); toggleLike(this);">
                                    <i class="far fa-heart text-danger"></i> <span class="like-count">203</span>
                                </span>
                            </div>
                            <div class="story-actions d-flex gap-2 mt-2">
                                <button class="btn btn-outline-primary flex-fill" onclick="event.stopPropagation(); window.location.href='story.html';">عرض التفاصيل</button>
                                <div class="story-owner-actions" data-owner="khalid" style="display: none;">
                                    <button class="btn btn-outline-warning btn-sm" onclick="event.stopPropagation(); editStory(3);" title="تعديل">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="event.stopPropagation(); deleteStory(3);" title="حذف">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-6 col-xl-4" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="100">
                    <div class="story-card h-100">
                        <div class="story-media">
                            <img src="images/4dd0f026e751148098e7004eae353068.jpg" class="img-fluid" alt="قصة تطوعية">
                            <div class="media-overlay">
                                <div class="media-type">
                                    <i class="fas fa-image"></i>
                                </div>
                            </div>
                        </div>
                        <div class="story-content">
                            <div class="story-meta">
                                <span class="badge badge-custom">تعليم</span>
                                <span class="story-date">منذ أسبوع</span>
                            </div>
                            <h5 class="story-title">تجربتي في تعليم الكبار</h5>
                            <p class="story-excerpt">كيف ساعدت في تعليم الكبار القراءة والكتابة في مجتمعي المحلي</p>
                            <div class="story-author">
                                <img src="images/man1.jpg" class="author-avatar" alt="المؤلف">
                                <div class="author-info">
                                    <h6>أحمد محمد</h6>
                                    <small>متطوع منذ 2021</small>
                                </div>
                            </div>
                            <div class="story-stats">
                                <span class="like-btn" data-story-id="4" onclick="event.stopPropagation(); toggleLike(this);">
                                    <i class="far fa-heart text-danger"></i> <span class="like-count">89</span>
                                </span>
                            </div>
                            <div class="story-actions d-flex gap-2 mt-2">
                                <button class="btn btn-outline-primary flex-fill" onclick="event.stopPropagation(); window.location.href='story.html';">عرض التفاصيل</button>
                                <div class="story-owner-actions" data-owner="ahmed" style="display: none;">
                                    <button class="btn btn-outline-warning btn-sm" onclick="event.stopPropagation(); editStory(4);" title="تعديل">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="event.stopPropagation(); deleteStory(4);" title="حذف">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-6 col-xl-4" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="100">
                    <div class="story-card h-100">
                        <div class="story-media">
                            <img src="images/4dd0f026e751148098e7004eae353068.jpg" class="img-fluid" alt="قصة تطوعية">
                            <div class="media-overlay">
                                <div class="media-type">
                                    <i class="fas fa-image"></i>
                                </div>
                            </div>
                        </div>
                        <div class="story-content">
                            <div class="story-meta">
                                <span class="badge badge-custom">تعليم</span>
                                <span class="story-date">منذ أسبوع</span>
                            </div>
                            <h5 class="story-title">تجربتي في تعليم الكبار</h5>
                            <p class="story-excerpt">كيف ساعدت في تعليم الكبار القراءة والكتابة في مجتمعي المحلي</p>
                            <div class="story-author">
                                <img src="images/man1.jpg" class="author-avatar" alt="المؤلف">
                                <div class="author-info">
                                    <h6>أحمد محمد</h6>
                                    <small>متطوع منذ 2021</small>
                                </div>
                            </div>
                            <div class="story-stats">
                                <span class="like-btn" data-story-id="5" onclick="event.stopPropagation(); toggleLike(this);">
                                    <i class="far fa-heart text-danger"></i> <span class="like-count">89</span>
                                </span>
                            </div>
                            <div class="story-actions d-flex gap-2 mt-2">
                                <button class="btn btn-outline-primary flex-fill" onclick="event.stopPropagation(); window.location.href='story.html';">عرض التفاصيل</button>
                                <div class="story-owner-actions" data-owner="ahmed" style="display: none;">
                                    <button class="btn btn-outline-warning btn-sm" onclick="event.stopPropagation(); editStory(5);" title="تعديل">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="event.stopPropagation(); deleteStory(5);" title="حذف">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-sm-6 col-lg-6 col-xl-4" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="100">
                    <div class="story-card h-100">
                        <div class="story-media">
                            <img src="images/4dd0f026e751148098e7004eae353068.jpg" class="img-fluid" alt="قصة تطوعية">
                            <div class="media-overlay">
                                <div class="media-type">
                                    <i class="fas fa-image"></i>
                                </div>
                            </div>
                        </div>
                        <div class="story-content">
                            <div class="story-meta">
                                <span class="badge badge-custom">تعليم</span>
                                <span class="story-date">منذ أسبوع</span>
                            </div>
                            <h5 class="story-title">تجربتي في تعليم الكبار</h5>
                            <p class="story-excerpt">كيف ساعدت في تعليم الكبار القراءة والكتابة في مجتمعي المحلي</p>
                            <div class="story-author">
                                <img src="images/man1.jpg" class="author-avatar" alt="المؤلف">
                                <div class="author-info">
                                    <h6>أحمد محمد</h6>
                                    <small>متطوع منذ 2021</small>
                                </div>
                            </div>
                            <div class="story-stats">
                                <span class="like-btn" data-story-id="6" onclick="event.stopPropagation(); toggleLike(this);">
                                    <i class="far fa-heart text-danger"></i> <span class="like-count">89</span>
                                </span>
                            </div>
                            <div class="story-actions d-flex gap-2 mt-2">
                                <button class="btn btn-outline-primary flex-fill" onclick="event.stopPropagation(); window.location.href='story.html';">عرض التفاصيل</button>
                                <div class="story-owner-actions" data-owner="ahmed" style="display: none;">
                                    <button class="btn btn-outline-warning btn-sm" onclick="event.stopPropagation(); editStory(6);" title="تعديل">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="event.stopPropagation(); deleteStory(6);" title="حذف">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
         

            <!-- Load More Button -->
            <div class="text-center mt-5" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="400">
                <button class="btn btn-primary-custom" onclick="loadMoreStories()">
                    <i class="fas fa-plus me-2"></i>تحميل المزيد
                </button>
            </div>
        </div>
    </section>

   

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <h5>منصة التطوع السعودية</h5>
                    <p>منصة وطنية تهدف إلى ربط المتطوعين مع المبادرات والمنصات الداعمة للتطوع في المملكة العربية السعودية، لنشر ثقافة العمل التطوعي وتعزيز المشاركة المجتمعية.</p>
                </div>
                <div class="col-lg-2 col-md-6 mb-4">
                    <h5>روابط سريعة</h5>
                    <div class="footer-links">
                        <a href="index.html">الرئيسية</a>
                        <a href="index.html#volunteers">المتطوعون</a>
                        <a href="initiatives.html">المبادرات</a>
                        <a href="platforms.html">المنصات الداعمة</a>
                        <a href="community.html">مجتمع التطوع</a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <h5>المجالات التطوعية</h5>
                    <div class="footer-links">
                        <a href="initiatives.html">التعليم</a>
                        <a href="initiatives.html">الصحة</a>
                        <a href="initiatives.html">البيئة</a>
                        <a href="initiatives.html">الإغاثة</a>
                        <a href="initiatives.html">التوعية</a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <h5>اتصل بنا</h5>
                    <div class="footer-links">
                        <p><i class="fas fa-map-marker-alt me-2"></i> الرياض، المملكة العربية السعودية</p>
                        <p><i class="fas fa-envelope me-2"></i> info@volunteer-platform.sa</p>
                    </div>
                </div>
            </div>
            <div class="copyright">
                <p>جميع الحقوق محفوظة &copy; 2025 منصة التطوع السعودية</p>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top Button -->
    <div class="scroll-top" id="scrollTop">
        <i class="fas fa-arrow-up"></i>
    </div>

    <!-- Add Story Modal -->
    <div class="modal fade" id="addStoryModal" tabindex="-1" aria-labelledby="addStoryModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addStoryModalLabel">
                        <i class="fas fa-plus-circle me-2"></i>إضافة قصة جديدة
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addStoryForm">
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="add-story-title" class="form-label">عنوان القصة <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="add-story-title" required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="add-story-category" class="form-label">الفئة <span class="text-danger">*</span></label>
                                <select class="form-select" id="add-story-category" required>
                                    <option value="">اختر الفئة</option>
                                    <option value="education">التعليم</option>
                                    <option value="health">الصحة</option>
                                    <option value="environment">البيئة</option>
                                    <option value="relief">الإغاثة</option>
                                    <option value="awareness">التوعية</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="add-story-region" class="form-label">المنطقة <span class="text-danger">*</span></label>
                                <select class="form-select" id="add-story-region" required>
                                    <option value="">اختر المنطقة</option>
                                    <option value="riyadh">الرياض</option>
                                    <option value="jeddah">جدة</option>
                                    <option value="dammam">الدمام</option>
                                    <option value="makkah">مكة المكرمة</option>
                                    <option value="medina">المدينة المنورة</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="add-story-description" class="form-label">وصف القصة <span class="text-danger">*</span></label>
                                <textarea class="form-control" id="add-story-description" rows="4" required placeholder="اكتب وصفاً مختصراً عن قصة التطوع الخاصة بك..."></textarea>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="add-story-keywords" class="form-label">الكلمات المفتاحية</label>
                                <input type="text" class="form-control" id="add-story-keywords" placeholder="مثال: تعليم، أطفال، تطوع، مجتمع (افصل بين الكلمات بفواصل)">
                                <small class="text-muted">افصل بين الكلمات بفواصل أو مسافات</small>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="add-story-media" class="form-label">الوسائط (صور وفيديوهات) <span class="text-danger">*</span></label>
                                <input type="file" class="form-control" id="add-story-media" accept="image/*,video/*" multiple required>
                                <small class="text-muted">يمكنك رفع عدة صور أو فيديوهات (الحجم الأقصى لكل ملف: 10MB)</small>
                                <div id="add-media-preview" class="mt-3" style="display: none;">
                                    <div class="d-flex flex-wrap gap-2" id="add-media-preview-container">
                                        <!-- Media previews will be added here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-primary-custom" onclick="saveNewStory()">
                        <i class="fas fa-save me-2"></i>حفظ القصة
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Story Modal -->
    <div class="modal fade" id="editStoryModal" tabindex="-1" aria-labelledby="editStoryModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editStoryModalLabel">
                        <i class="fas fa-edit me-2"></i>تعديل القصة
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editStoryForm">
                        <input type="hidden" id="edit-story-id">
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="edit-story-title" class="form-label">عنوان القصة <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="edit-story-title" required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="edit-story-category" class="form-label">الفئة <span class="text-danger">*</span></label>
                                <select class="form-select" id="edit-story-category" required>
                                    <option value="">اختر الفئة</option>
                                    <option value="education">التعليم</option>
                                    <option value="health">الصحة</option>
                                    <option value="environment">البيئة</option>
                                    <option value="relief">الإغاثة</option>
                                    <option value="awareness">التوعية</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="edit-story-region" class="form-label">المنطقة <span class="text-danger">*</span></label>
                                <select class="form-select" id="edit-story-region" required>
                                    <option value="">اختر المنطقة</option>
                                    <option value="riyadh">الرياض</option>
                                    <option value="jeddah">جدة</option>
                                    <option value="dammam">الدمام</option>
                                    <option value="makkah">مكة المكرمة</option>
                                    <option value="medina">المدينة المنورة</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="edit-story-description" class="form-label">وصف القصة <span class="text-danger">*</span></label>
                                <textarea class="form-control" id="edit-story-description" rows="4" required></textarea>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="edit-story-keywords" class="form-label">الكلمات المفتاحية</label>
                                <input type="text" class="form-control" id="edit-story-keywords" placeholder="مثال: تعليم، أطفال، تطوع، مجتمع (افصل بين الكلمات بفواصل)">
                                <small class="text-muted">افصل بين الكلمات بفواصل أو مسافات</small>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="edit-story-media" class="form-label">إضافة وسائط جديدة</label>
                                <input type="file" class="form-control" id="edit-story-media" accept="image/*,video/*" multiple>
                                <small class="text-muted">يمكنك إضافة صور أو فيديوهات جديدة (اتركه فارغاً للاحتفاظ بالوسائط الحالية)</small>
                                <div id="edit-new-media-preview" class="mt-3" style="display: none;">
                                    <div class="d-flex flex-wrap gap-2" id="edit-new-media-preview-container">
                                        <!-- New media previews will be added here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label class="form-label">الوسائط الحالية</label>
                                <div id="edit-current-media-preview" class="d-flex flex-wrap gap-2 mt-2">
                                    <!-- Current media previews will be shown here -->
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-primary-custom" onclick="saveEditedStory()">
                        <i class="fas fa-save me-2"></i>حفظ التعديلات
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- AOS JS -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <!-- Toastify JS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    
   
    <script>
        // Initialize AOS
        AOS.init({
            duration: 1000,
            once: true,
            offset: 100
        });

        // Current user (simulated - in real app, get from session)
        const currentUser = 'ahmed'; // Change this to match story owners
        const likedStories = JSON.parse(localStorage.getItem('likedStories') || '[]');
        const userStories = JSON.parse(localStorage.getItem('userStories') || '[]');
        
        // Story data (simulated - in real app, fetch from API)
        let storiesData = {
            1: { id: 1, title: 'تجربتي في تعليم الكبار', category: 'education', region: 'riyadh', description: 'كيف ساعدت في تعليم الكبار القراءة والكتابة في مجتمعي المحلي', keywords: ['تعليم', 'كبار', 'مجتمع', 'قراءة'], media: [{type: 'image', src: 'images/4dd0f026e751148098e7004eae353068.jpg'}], likes: 89, owner: 'ahmed' },
            2: { id: 2, title: 'رحلة العطاء في المجال الصحي', category: 'health', region: 'jeddah', description: 'فيديو يوثق تجربة متطوعة في تقديم الخدمات الصحية للمجتمع', keywords: ['صحة', 'خدمة', 'مجتمع', 'رعاية'], media: [{type: 'video', src: 'videos/volunteer-story1.mp4', poster: 'images/fe5f8099c3041cec30afe8ed0d2df5e3.jpg'}], likes: 156, owner: 'nora' },
            3: { id: 3, title: 'حملة تنظيف الشواطئ', category: 'environment', region: 'jeddah', description: 'مشاركة في حملة تنظيف شواطئ جدة وحماية البيئة البحرية', keywords: ['بيئة', 'تنظيف', 'شواطئ', 'حماية'], media: [{type: 'image', src: 'images/736cb88a471f0ac9354ace1886ebab18.jpg'}], likes: 203, owner: 'khalid' },
            4: { id: 4, title: 'تجربتي في تعليم الكبار', category: 'education', region: 'riyadh', description: 'كيف ساعدت في تعليم الكبار القراءة والكتابة في مجتمعي المحلي', keywords: ['تعليم', 'كبار', 'مجتمع', 'تطوع'], media: [{type: 'image', src: 'images/4dd0f026e751148098e7004eae353068.jpg'}], likes: 89, owner: 'ahmed' },
            5: { id: 5, title: 'تجربتي في تعليم الكبار', category: 'education', region: 'riyadh', description: 'كيف ساعدت في تعليم الكبار القراءة والكتابة في مجتمعي المحلي', keywords: ['تعليم', 'كبار', 'مجتمع', 'تنمية'], media: [{type: 'image', src: 'images/4dd0f026e751148098e7004eae353068.jpg'}], likes: 89, owner: 'ahmed' },
            6: { id: 6, title: 'تجربتي في تعليم الكبار', category: 'education', region: 'riyadh', description: 'كيف ساعدت في تعليم الكبار القراءة والكتابة في مجتمعي المحلي', keywords: ['تعليم', 'كبار', 'مجتمع', 'إنسانية'], media: [{type: 'image', src: 'images/4dd0f026e751148098e7004eae353068.jpg'}], likes: 89, owner: 'ahmed' }
        };
        
        // Initialize stories on page load
        function initializeStories() {
            document.querySelectorAll('.story-card').forEach((card, index) => {
                const storyId = index + 1;
                const ownerActions = card.querySelector('.story-owner-actions');
                const story = storiesData[storyId];
                
                if (ownerActions && story && story.owner === currentUser) {
                    ownerActions.style.display = 'flex';
                }
                
                // Check if story is liked
                const likeBtn = card.querySelector('.like-btn');
                if (likeBtn) {
                    const icon = likeBtn.querySelector('i');
                    if (likedStories.includes(storyId)) {
                        likeBtn.classList.add('liked');
                        if (icon) icon.className = 'fas fa-heart text-danger';
                    } else {
                        if (icon) icon.className = 'far fa-heart text-danger';
                    }
                }
                
                // Add keywords if they exist
                if (story && story.keywords && story.keywords.length > 0) {
                    const excerpt = card.querySelector('.story-excerpt');
                    if (excerpt) {
                        // Check if keywords section already exists
                        let keywordsDiv = card.querySelector('.story-keywords');
                        if (!keywordsDiv) {
                            keywordsDiv = document.createElement('div');
                            keywordsDiv.className = 'story-keywords mt-2 mb-2';
                            excerpt.parentNode.insertBefore(keywordsDiv, excerpt.nextSibling);
                        }
                        keywordsDiv.innerHTML = `
                            <small class="text-muted d-block mb-1"><i class="fas fa-tags me-1"></i>الكلمات المفتاحية:</small>
                            <div class="d-flex flex-wrap gap-1">
                                ${story.keywords.map(kw => `<span class="badge bg-secondary">${kw}</span>`).join('')}
                            </div>
                        `;
                    }
                }
            });
        }
        
        // Toggle like functionality
        function toggleLike(btn) {
            const storyId = parseInt(btn.getAttribute('data-story-id'));
            const likeCount = btn.querySelector('.like-count');
            const icon = btn.querySelector('i');
            let currentLikes = parseInt(likeCount.textContent) || 0;
            
            if (likedStories.includes(storyId)) {
                // Unlike
                likedStories.splice(likedStories.indexOf(storyId), 1);
                currentLikes--;
                btn.classList.remove('liked');
                icon.className = 'far fa-heart text-danger';
                
                Toastify({
                    text: "تم إلغاء الإعجاب بالقصة",
                    duration: 2000,
                    gravity: "top",
                    position: 'left',
                    backgroundColor: "linear-gradient(to right, #6c757d, #5a6268)",
                    stopOnFocus: true
                }).showToast();
            } else {
                // Like
                likedStories.push(storyId);
                currentLikes++;
                btn.classList.add('liked');
                icon.className = 'fas fa-heart text-danger';
                
                Toastify({
                    text: "تم الإعجاب بالقصة!",
                    duration: 2000,
                    gravity: "top",
                    position: 'left',
                    backgroundColor: "linear-gradient(to right, #dc3545, #c82333)",
                    stopOnFocus: true
                }).showToast();
            }
            
            likeCount.textContent = currentLikes;
            localStorage.setItem('likedStories', JSON.stringify(likedStories));
            
            // Update story data
            if (storiesData[storyId]) {
                storiesData[storyId].likes = currentLikes;
            }
        }
        
        // Edit Story
        function editStory(storyId) {
            const story = storiesData[storyId];
            if (!story) {
                Toastify({
                    text: "القصة غير موجودة",
                    duration: 2000,
                    gravity: "top",
                    position: 'left',
                    backgroundColor: "linear-gradient(to right, #dc3545, #c82333)",
                    stopOnFocus: true
                }).showToast();
                return;
            }
            
            document.getElementById('edit-story-id').value = storyId;
            document.getElementById('edit-story-title').value = story.title;
            document.getElementById('edit-story-category').value = story.category;
            document.getElementById('edit-story-region').value = story.region;
            document.getElementById('edit-story-description').value = story.description;
            document.getElementById('edit-story-keywords').value = story.keywords ? story.keywords.join('، ') : '';
            
            // Show current media previews
            const currentMediaContainer = document.getElementById('edit-current-media-preview');
            currentMediaContainer.innerHTML = '';
            
            if (story.media && story.media.length > 0) {
                story.media.forEach((mediaItem, index) => {
                    const mediaDiv = document.createElement('div');
                    mediaDiv.className = 'position-relative';
                    mediaDiv.style.width = '150px';
                    
                    if (mediaItem.type === 'image') {
                        mediaDiv.innerHTML = `
                            <img src="${mediaItem.src}" class="img-thumbnail" style="width: 150px; height: 150px; object-fit: cover;">
                            <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0" onclick="removeCurrentMedia(${storyId}, ${index})" style="transform: translate(50%, -50%);">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                    } else {
                        mediaDiv.innerHTML = `
                            <video class="img-thumbnail" poster="${mediaItem.poster || ''}" style="width: 150px; height: 150px; object-fit: cover;">
                                <source src="${mediaItem.src}" type="video/mp4">
                            </video>
                            <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0" onclick="removeCurrentMedia(${storyId}, ${index})" style="transform: translate(50%, -50%);">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                    }
                    currentMediaContainer.appendChild(mediaDiv);
                });
            }
            
            const editModal = new bootstrap.Modal(document.getElementById('editStoryModal'));
            editModal.show();
        }
        
        // Delete Story
        function deleteStory(storyId) {
            if (!confirm('هل أنت متأكد من حذف هذه القصة؟')) {
                return;
            }
            
            const storyCard = document.querySelector(`[data-story-id="${storyId}"], .story-card:nth-child(${storyId})`);
            if (storyCard && storyCard.closest('.col-12')) {
                storyCard.closest('.col-12').remove();
            }
            
            delete storiesData[storyId];
            
            Toastify({
                text: "تم حذف القصة بنجاح",
                duration: 2000,
                gravity: "top",
                position: 'left',
                backgroundColor: "linear-gradient(to right, #28a745, #20c997)",
                stopOnFocus: true
            }).showToast();
        }
        
        // Save New Story
        function saveNewStory() {
            const form = document.getElementById('addStoryForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            const title = document.getElementById('add-story-title').value;
            const category = document.getElementById('add-story-category').value;
            const region = document.getElementById('add-story-region').value;
            const description = document.getElementById('add-story-description').value;
            const keywordsInput = document.getElementById('add-story-keywords').value.trim();
            const mediaFiles = document.getElementById('add-story-media').files;
            
            // Parse keywords (split by comma or space)
            const keywords = keywordsInput ? keywordsInput.split(/[،,,\s]+/).filter(k => k.trim()).map(k => k.trim()) : [];
            
            if (!mediaFiles || mediaFiles.length === 0) {
                Toastify({
                    text: "يرجى إضافة صورة أو فيديو واحد على الأقل",
                    duration: 2000,
                    gravity: "top",
                    position: 'left',
                    backgroundColor: "linear-gradient(to right, #dc3545, #c82333)",
                    stopOnFocus: true
                }).showToast();
                return;
            }
            
            // Create new story ID
            const newId = Math.max(...Object.keys(storiesData).map(Number), ...userStories.map(s => s.id), 0) + 1;
            
            // Process media files
            const mediaArray = [];
            for (let i = 0; i < mediaFiles.length; i++) {
                const file = mediaFiles[i];
                const mediaUrl = URL.createObjectURL(file);
                const mediaType = file.type.startsWith('image/') ? 'image' : 'video';
                mediaArray.push({
                    type: mediaType,
                    src: mediaUrl,
                    poster: mediaType === 'video' ? '' : undefined
                });
            }
            
            const newStory = {
                id: newId,
                title: title,
                category: category,
                region: region,
                description: description,
                keywords: keywords,
                media: mediaArray,
                likes: 0,
                owner: currentUser
            };
            
            storiesData[newId] = newStory;
            userStories.push(newStory);
            localStorage.setItem('userStories', JSON.stringify(userStories));
            
            // Add story card to DOM
            addStoryCardToDOM(newStory);
            
            // Reset form
            form.reset();
            document.getElementById('add-story-keywords').value = '';
            document.getElementById('add-media-preview').style.display = 'none';
            document.getElementById('add-media-preview-container').innerHTML = '';
            
            // Close modal
            const addModal = bootstrap.Modal.getInstance(document.getElementById('addStoryModal'));
            addModal.hide();
            
            Toastify({
                text: "تم إضافة القصة بنجاح!",
                duration: 2000,
                gravity: "top",
                position: 'left',
                backgroundColor: "linear-gradient(to right, #28a745, #20c997)",
                stopOnFocus: true
            }).showToast();
        }
        
        // Remove current media from edit
        function removeCurrentMedia(storyId, mediaIndex) {
            const story = storiesData[storyId];
            if (story && story.media && story.media.length > mediaIndex) {
                story.media.splice(mediaIndex, 1);
                // Refresh current media preview
                editStory(storyId);
            }
        }
        
        // Save Edited Story
        function saveEditedStory() {
            const form = document.getElementById('editStoryForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            const storyId = parseInt(document.getElementById('edit-story-id').value);
            const story = storiesData[storyId];
            if (!story) return;
            
            story.title = document.getElementById('edit-story-title').value;
            story.category = document.getElementById('edit-story-category').value;
            story.region = document.getElementById('edit-story-region').value;
            story.description = document.getElementById('edit-story-description').value;
            
            // Update keywords
            const keywordsInput = document.getElementById('edit-story-keywords').value.trim();
            story.keywords = keywordsInput ? keywordsInput.split(/[،,,\s]+/).filter(k => k.trim()).map(k => k.trim()) : [];
            
            // Add new media files if any
            const newMediaFiles = document.getElementById('edit-story-media').files;
            if (newMediaFiles && newMediaFiles.length > 0) {
                for (let i = 0; i < newMediaFiles.length; i++) {
                    const file = newMediaFiles[i];
                    const mediaUrl = URL.createObjectURL(file);
                    const mediaType = file.type.startsWith('image/') ? 'image' : 'video';
                    story.media.push({
                        type: mediaType,
                        src: mediaUrl,
                        poster: mediaType === 'video' ? '' : undefined
                    });
                }
            }
            
            // Update story card in DOM
            updateStoryCardInDOM(story);
            
            // Reset form
            document.getElementById('edit-story-media').value = '';
            document.getElementById('edit-new-media-preview').style.display = 'none';
            document.getElementById('edit-new-media-preview-container').innerHTML = '';
            
            // Close modal
            const editModal = bootstrap.Modal.getInstance(document.getElementById('editStoryModal'));
            editModal.hide();
            
            Toastify({
                text: "تم تحديث القصة بنجاح!",
                duration: 2000,
                gravity: "top",
                position: 'left',
                backgroundColor: "linear-gradient(to right, #28a745, #20c997)",
                stopOnFocus: true
            }).showToast();
        }
        
        // Add story card to DOM
        function addStoryCardToDOM(story) {
            const storiesRow = document.querySelector('#stories .row.g-4');
            if (!storiesRow) return;
            
            const categoryNames = {
                'education': 'تعليم',
                'health': 'صحة',
                'environment': 'بيئة',
                'relief': 'إغاثة',
                'awareness': 'توعية'
            };
            
            const col = document.createElement('div');
            col.className = 'col-12 col-sm-6 col-lg-6 col-xl-4';
            col.setAttribute('data-aos', 'fade-up');
            col.setAttribute('data-aos-duration', '1000');
            
            // Build media HTML - show first media item
            let mediaHtml = '';
            let mediaIcon = 'fa-image';
            if (story.media && story.media.length > 0) {
                const firstMedia = story.media[0];
                if (firstMedia.type === 'image') {
                    mediaHtml = `<img src="${firstMedia.src}" class="img-fluid" alt="${story.title}">`;
                    mediaIcon = 'fa-image';
                } else {
                    mediaHtml = `<video class="img-fluid" poster="${firstMedia.poster || ''}"><source src="${firstMedia.src}" type="video/mp4"></video>`;
                    mediaIcon = 'fa-play';
                }
            } else {
                mediaHtml = `<img src="images/default.jpg" class="img-fluid" alt="${story.title}">`;
            }
            
            col.innerHTML = `
                <div class="story-card h-100">
                    <div class="story-media">
                        ${mediaHtml}
                        <div class="media-overlay">
                            <div class="media-type">
                                <i class="fas ${mediaIcon}"></i>
                            </div>
                        </div>
                    </div>
                    <div class="story-content">
                        <div class="story-meta">
                            <span class="badge badge-custom">${categoryNames[story.category] || story.category}</span>
                            <span class="meta-author">
                                <img class="meta-avatar" src="images/man1.jpg" alt="المؤلف">
                                <span class="meta-name">أحمد محمد</span>
                            </span>
                            <span class="meta-stats">
                                <span class="like-btn" data-story-id="${story.id}" onclick="event.stopPropagation(); toggleLike(this);">
                                    <i class="far fa-heart text-danger"></i> <span class="like-count">${story.likes}</span>
                                </span>
                            </span>
                        </div>
                        <h5 class="story-title">${story.title}</h5>
                        <p class="story-excerpt">${story.description}</p>
                        ${story.keywords && story.keywords.length > 0 ? `
                        <div class="story-keywords mt-2 mb-2">
                            <small class="text-muted d-block mb-1"><i class="fas fa-tags me-1"></i>الكلمات المفتاحية:</small>
                            <div class="d-flex flex-wrap gap-1">
                                ${story.keywords.map(kw => `<span class="badge bg-secondary">${kw}</span>`).join('')}
                            </div>
                        </div>
                        ` : ''}
                        <div class="story-author" style="display: none;">
                            <img src="images/man1.jpg" class="author-avatar" alt="المؤلف">
                            <div class="author-info">
                                <h6>أحمد محمد</h6>
                                <small>متطوع منذ 2021</small>
                            </div>
                        </div>
                        <div class="story-stats" style="display: none;">
                            <span class="like-btn" data-story-id="${story.id}" onclick="event.stopPropagation(); toggleLike(this);">
                                <i class="far fa-heart text-danger"></i> <span class="like-count">${story.likes}</span>
                            </span>
                        </div>
                        <div class="story-actions d-flex gap-2 mt-2">
                            <button class="btn btn-outline-primary flex-fill" onclick="event.stopPropagation(); window.location.href='story.html';">عرض التفاصيل</button>
                            <div class="story-owner-actions" data-owner="${story.owner}" style="display: ${story.owner === currentUser ? 'flex' : 'none'};">
                                <button class="btn btn-outline-warning btn-sm" onclick="event.stopPropagation(); editStory(${story.id});" title="تعديل">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-outline-danger btn-sm" onclick="event.stopPropagation(); deleteStory(${story.id});" title="حذف">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            storiesRow.appendChild(col);
            
            // Reinitialize AOS
            AOS.refresh();
        }
        
        // Update story card in DOM
        function updateStoryCardInDOM(story) {
            const storyCard = Array.from(document.querySelectorAll('.story-card')).find(card => {
                const likeBtn = card.querySelector('.like-btn');
                return likeBtn && parseInt(likeBtn.getAttribute('data-story-id')) === story.id;
            });
            
            if (!storyCard) return;
            
            const categoryNames = {
                'education': 'تعليم',
                'health': 'صحة',
                'environment': 'بيئة',
                'relief': 'إغاثة',
                'awareness': 'توعية'
            };
            
            // Update title
            const titleEl = storyCard.querySelector('.story-title');
            if (titleEl) titleEl.textContent = story.title;
            
            // Update description
            const descEl = storyCard.querySelector('.story-excerpt');
            if (descEl) descEl.textContent = story.description;
            
            // Update keywords
            let keywordsDiv = storyCard.querySelector('.story-keywords');
            if (story.keywords && story.keywords.length > 0) {
                if (!keywordsDiv) {
                    keywordsDiv = document.createElement('div');
                    keywordsDiv.className = 'story-keywords mt-2 mb-2';
                    descEl.parentNode.insertBefore(keywordsDiv, descEl.nextSibling);
                }
                keywordsDiv.innerHTML = `
                    <small class="text-muted d-block mb-1"><i class="fas fa-tags me-1"></i>الكلمات المفتاحية:</small>
                    <div class="d-flex flex-wrap gap-1">
                        ${story.keywords.map(kw => `<span class="badge bg-secondary">${kw}</span>`).join('')}
                    </div>
                `;
            } else if (keywordsDiv) {
                keywordsDiv.remove();
            }
            
            // Update category badge
            const badgeEl = storyCard.querySelector('.badge');
            if (badgeEl) badgeEl.textContent = categoryNames[story.category] || story.category;
            
            // Update media - show first media item
            const mediaEl = storyCard.querySelector('.story-media');
            if (mediaEl && story.media && story.media.length > 0) {
                const firstMedia = story.media[0];
                if (firstMedia.type === 'image') {
                    mediaEl.innerHTML = `
                        <img src="${firstMedia.src}" class="img-fluid" alt="${story.title}">
                        <div class="media-overlay">
                            <div class="media-type">
                                <i class="fas fa-image"></i>
                            </div>
                        </div>
                    `;
                } else {
                    mediaEl.innerHTML = `
                        <video class="img-fluid" poster="${firstMedia.poster || ''}">
                            <source src="${firstMedia.src}" type="video/mp4">
                        </video>
                        <div class="media-overlay">
                            <div class="media-type">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                    `;
                }
            }
        }
        
        // Preview media for add form (multiple files)
        document.getElementById('add-story-media')?.addEventListener('change', function(e) {
            const files = e.target.files;
            if (!files || files.length === 0) {
                document.getElementById('add-media-preview').style.display = 'none';
                return;
            }
            
            const previewContainer = document.getElementById('add-media-preview-container');
            previewContainer.innerHTML = '';
            
            Array.from(files).forEach((file, index) => {
                const mediaDiv = document.createElement('div');
                mediaDiv.className = 'position-relative';
                mediaDiv.style.width = '150px';
                
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        mediaDiv.innerHTML = `
                            <img src="${e.target.result}" class="img-thumbnail" style="width: 150px; height: 150px; object-fit: cover;">
                            <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0" onclick="removeAddMediaPreview(${index})" style="transform: translate(50%, -50%);">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                    };
                    reader.readAsDataURL(file);
                } else if (file.type.startsWith('video/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        mediaDiv.innerHTML = `
                            <video class="img-thumbnail" style="width: 150px; height: 150px; object-fit: cover;">
                                <source src="${e.target.result}" type="video/mp4">
                            </video>
                            <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0" onclick="removeAddMediaPreview(${index})" style="transform: translate(50%, -50%);">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                    };
                    reader.readAsDataURL(file);
                }
                
                previewContainer.appendChild(mediaDiv);
            });
            
            document.getElementById('add-media-preview').style.display = 'block';
        });
        
        // Preview new media for edit form (multiple files)
        document.getElementById('edit-story-media')?.addEventListener('change', function(e) {
            const files = e.target.files;
            if (!files || files.length === 0) {
                document.getElementById('edit-new-media-preview').style.display = 'none';
                return;
            }
            
            const previewContainer = document.getElementById('edit-new-media-preview-container');
            previewContainer.innerHTML = '';
            
            Array.from(files).forEach((file, index) => {
                const mediaDiv = document.createElement('div');
                mediaDiv.className = 'position-relative';
                mediaDiv.style.width = '150px';
                
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        mediaDiv.innerHTML = `
                            <img src="${e.target.result}" class="img-thumbnail" style="width: 150px; height: 150px; object-fit: cover;">
                            <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0" onclick="removeEditMediaPreview(${index})" style="transform: translate(50%, -50%);">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                    };
                    reader.readAsDataURL(file);
                } else if (file.type.startsWith('video/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        mediaDiv.innerHTML = `
                            <video class="img-thumbnail" style="width: 150px; height: 150px; object-fit: cover;">
                                <source src="${e.target.result}" type="video/mp4">
                            </video>
                            <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0" onclick="removeEditMediaPreview(${index})" style="transform: translate(50%, -50%);">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                    };
                    reader.readAsDataURL(file);
                }
                
                previewContainer.appendChild(mediaDiv);
            });
            
            document.getElementById('edit-new-media-preview').style.display = 'block';
        });
        
        // Remove media preview from add form
        function removeAddMediaPreview(index) {
            const input = document.getElementById('add-story-media');
            const dt = new DataTransfer();
            const files = Array.from(input.files);
            
            files.forEach((file, i) => {
                if (i !== index) {
                    dt.items.add(file);
                }
            });
            
            input.files = dt.files;
            input.dispatchEvent(new Event('change'));
        }
        
        // Remove media preview from edit form
        function removeEditMediaPreview(index) {
            const input = document.getElementById('edit-story-media');
            const dt = new DataTransfer();
            const files = Array.from(input.files);
            
            files.forEach((file, i) => {
                if (i !== index) {
                    dt.items.add(file);
                }
            });
            
            input.files = dt.files;
            input.dispatchEvent(new Event('change'));
        }
        
        // Story card navigation to detail page
        document.addEventListener('DOMContentLoaded', () => {
            initializeStories();
            // Move author info into meta and remove date
            document.querySelectorAll('.story-card').forEach(card => {
                const meta = card.querySelector('.story-meta');
                const author = card.querySelector('.story-author');
                if (!meta || !author) return;

                const dateEl = meta.querySelector('.story-date');
                if (dateEl) dateEl.remove();

                const avatar = author.querySelector('img');
                const nameEl = author.querySelector('.author-info h6');
                const compact = document.createElement('span');
                compact.className = 'meta-author';
                compact.innerHTML = `
                    <img class="meta-avatar" src="${avatar ? avatar.getAttribute('src') : 'images/avater.jpg'}" alt="المؤلف" onerror="this.src='images/avater.jpg'">
                    <span class="meta-name">${nameEl ? nameEl.textContent.trim() : 'متطوع'}</span>
                `;
                meta.appendChild(compact);

                // Move likes beside author in meta
                const stats = card.querySelector('.story-stats');
                if (stats) {
                    const metaStats = document.createElement('span');
                    metaStats.className = 'meta-stats';
                    metaStats.innerHTML = stats.innerHTML;
                    // Make sure author added first, then stats
                    meta.appendChild(compact); // add author
                    meta.appendChild(metaStats); // add likes state after author
                    stats.style.display = 'none';
                } else {
                    meta.appendChild(compact);
                }
                author.style.display = 'none';
            });
            document.querySelectorAll('.story-card, .featured-story-card').forEach(card => {
                card.style.cursor = 'pointer';
                card.addEventListener('click', (e) => {
                    const isInteractive = e.target.closest('a, button, .gallery-actions, .share-actions');
                    if (isInteractive) return;

                    const titleEl = card.querySelector('.story-title, .card-title');
                    const title = titleEl ? titleEl.textContent.trim() : 'قصة تطوعية';
                    const authorEl = card.querySelector('.author-info h6, .d-flex.align-items-center h5');
                    const author = authorEl ? authorEl.textContent.trim() : 'متطوع';
                    const badgeEl = card.querySelector('.badge, .badge-custom');
                    const category = badgeEl ? badgeEl.textContent.trim() : '';

                    const mediaImg = card.querySelector('.story-media img');
                    const mediaVideo = card.querySelector('.story-media video source');
                    const mainMedia = mediaImg ? mediaImg.getAttribute('src') : (mediaVideo ? mediaVideo.getAttribute('src') : '');

                    const params = new URLSearchParams();
                    params.set('t', title);
                    params.set('a', author);
                    if (category) params.set('c', category);
                    if (mainMedia) params.set('m', mainMedia);

                    window.location.href = `story.html?${params.toString()}`;
                });
            });
        });
        
        // Filter functionality
        function applyFilters() {
            const category = document.getElementById('categoryFilter').value;
            const type = document.getElementById('typeFilter').value;
            const region = document.getElementById('regionFilter').value;
            
            // Get all media containers
            const allMedia = document.getElementById('allMedia');
            const imagesMedia = document.getElementById('imagesMedia');
            const videosMedia = document.getElementById('videosMedia');
            
            // Filter function for each container
            function filterMedia(container) {
                if (!container) return;
                
                const items = container.querySelectorAll('[data-category], [data-type], [data-region]');
                
                items.forEach(item => {
                    let show = true;
                    
                    // Check category filter
                    if (category && item.getAttribute('data-category') !== category) {
                        show = false;
                    }
                    
                    // Check type filter
                    if (type && item.getAttribute('data-type') !== type) {
                        show = false;
                    }
                    
                    // Check region filter
                    if (region && item.getAttribute('data-region') !== region) {
                        show = false;
                    }
                    
                    // Show/hide item
                    if (show) {
                        item.style.display = 'block';
                        item.classList.add('filtered-in');
                        item.classList.remove('filtered-out');
                    } else {
                        item.style.display = 'none';
                        item.classList.add('filtered-out');
                        item.classList.remove('filtered-in');
                    }
                });
            }
            
            // Apply filters to all containers
            filterMedia(allMedia);
            filterMedia(imagesMedia);
            filterMedia(videosMedia);
            
            // Count visible items
            const visibleItems = document.querySelectorAll('.filtered-in').length;
            
            // Show toast notification
            Toastify({
                text: `تم تطبيق المرشحات بنجاح! ${visibleItems} عنصر متاح`,
                duration: 2000,
                gravity: "top",
                position: 'left',
                backgroundColor: "linear-gradient(to right, #005EA6, #008ECC)",
                stopOnFocus: true
            }).showToast();
        }
        
        // Clear filters
        function clearFilters() {
            document.getElementById('categoryFilter').value = '';
            document.getElementById('typeFilter').value = '';
            document.getElementById('regionFilter').value = '';
            
            // Show all items
            const allItems = document.querySelectorAll('[data-category], [data-type], [data-region]');
            allItems.forEach(item => {
                item.style.display = 'block';
                item.classList.remove('filtered-out', 'filtered-in');
            });
            
            Toastify({
                text: "تم مسح جميع المرشحات!",
                duration: 2000,
                gravity: "top",
                position: 'left',
                backgroundColor: "linear-gradient(to right, #28a745, #20c997)",
                stopOnFocus: true
            }).showToast();
        }
        
        // Load more stories
        function loadMoreStories() {
            Toastify({
                text: "جاري تحميل المزيد من القصص...",
                duration: 2000,
                gravity: "top",
                position: 'left',
                backgroundColor: "linear-gradient(to right, #005EA6, #008ECC)",
                stopOnFocus: true
            }).showToast();
        }

        // Gallery functionality - Best Practice Implementation
        class GalleryManager {
            constructor() {
                this.currentIndex = 0;
                this.items = [];
                this.modal = null;
                this.isAnimating = false;
                this.touchStartX = 0;
                this.touchStartY = 0;
                this.isSwipeStarted = false;
            }

            createGalleryControls(cardEl) {
                const actions = document.createElement('div');
                actions.className = 'gallery-actions';
                actions.innerHTML = `
                    <button type="button" class="gallery-btn" onclick="galleryManager.openGallery(this)">
                        <i class="fas fa-images"></i>
                        معرض
                    </button>
                `;

                const content = cardEl.querySelector('.story-content');
                if (!content) return;
                
                const stats = content.querySelector('.story-stats');
                if (stats) {
                    content.insertBefore(actions, stats);
                } else {
                    content.appendChild(actions);
                }
            }

            openGallery(button) {
                try {
                    const cardEl = button.closest('.story-card, .featured-story-card');
                    if (!cardEl) {
                        this.showError('عنصر القصة غير موجود');
                        return;
                    }

                    this.items = this.collectGalleryItems(cardEl);
                    if (this.items.length === 0) {
                        this.showError('لا توجد صور أو فيديوهات متاحة في المعرض');
                        return;
                    }

                    this.currentIndex = 0;
                    this.createModal();
                    this.showModal();
                } catch (error) {
                    console.error('Error opening gallery:', error);
                    this.showError('حدث خطأ في فتح المعرض');
                }
            }

            collectGalleryItems(cardEl) {
                const items = [];
                const mediaEl = cardEl.querySelector('.story-media');
                
                if (!mediaEl) return items;

                // Add main media
                const mainImg = mediaEl.querySelector('img');
                const mainVideo = mediaEl.querySelector('video');
                
                if (mainImg && mainImg.src) {
                    items.push({
                        type: 'image',
                        src: mainImg.src,
                        alt: mainImg.alt || 'صورة من المعرض',
                        title: cardEl.querySelector('.story-title')?.textContent || ''
                    });
                }
                
                if (mainVideo) {
                    const videoSrc = mainVideo.querySelector('source')?.src || mainVideo.src;
                    if (videoSrc) {
                        items.push({
                            type: 'video',
                            src: videoSrc,
                            poster: mainVideo.poster || '',
                            alt: 'فيديو من المعرض',
                            title: cardEl.querySelector('.story-title')?.textContent || ''
                        });
                    }
                }
                
                // Add related content based on story type
                const storyTitle = cardEl.querySelector('.story-title')?.textContent || '';
                const relatedItems = this.getRelatedContent(storyTitle);
                items.push(...relatedItems);
                
                return items;
            }

            getRelatedContent(storyTitle) {
                const relatedItems = [];
                
                if (storyTitle.includes('تعليم')) {
                    relatedItems.push(
                        { type: 'image', src: 'images/education.jpg', alt: 'صورة تعليمية', title: 'التعليم' },
                        { type: 'image', src: 'images/4dd0f026e751148098e7004eae353068.jpg', alt: 'صورة تعليمية', title: 'التعليم' },
                        { type: 'image', src: 'images/man1.jpg', alt: 'متطوع في التعليم', title: 'التعليم' },
                        { type: 'image', src: 'images/woman4.jpg', alt: 'متطوعة في التعليم', title: 'التعليم' }
                    );
                } else if (storyTitle.includes('صحة')) {
                    relatedItems.push(
                        { type: 'image', src: 'images/health.jpg', alt: 'صورة صحية', title: 'الصحة' },
                        { type: 'image', src: 'images/health2.jpg', alt: 'صورة صحية', title: 'الصحة' },
                        { type: 'image', src: 'images/woman5.jpg', alt: 'متطوعة في الصحة', title: 'الصحة' },
                        { type: 'image', src: 'images/fe5f8099c3041cec30afe8ed0d2df5e3.jpg', alt: 'صورة صحية', title: 'الصحة' }
                    );
                } else if (storyTitle.includes('بيئة')) {
                    relatedItems.push(
                        { type: 'image', src: 'images/736cb88a471f0ac9354ace1886ebab18.jpg', alt: 'صورة بيئية', title: 'البيئة' },
                        { type: 'image', src: 'images/eartg.jpg', alt: 'صورة بيئية', title: 'البيئة' },
                        { type: 'image', src: 'images/man2.jpg', alt: 'متطوع في البيئة', title: 'البيئة' },
                        { type: 'image', src: 'images/slid2.jpg', alt: 'صورة بيئية', title: 'البيئة' }
                    );
                } else {
                    // Default gallery items using available images
                    relatedItems.push(
                        { type: 'image', src: 'images/woman.jpg', alt: 'صورة من المعرض', title: 'معرض' },
                        { type: 'image', src: 'images/woman3.jpg', alt: 'صورة من المعرض', title: 'معرض' },
                        { type: 'image', src: 'images/wowan2.jpg', alt: 'صورة من المعرض', title: 'معرض' },
                        { type: 'image', src: 'images/avater.jpg', alt: 'صورة من المعرض', title: 'معرض' },
                        { type: 'image', src: 'images/avater2.jpg', alt: 'صورة من المعرض', title: 'معرض' },
                        { type: 'image', src: 'images/avater3.jpg', alt: 'صورة من المعرض', title: 'معرض' },
                        { type: 'image', src: 'images/avater4.jpg', alt: 'صورة من المعرض', title: 'معرض' },
                        { type: 'image', src: 'images/avater5.jpg', alt: 'صورة من المعرض', title: 'معرض' },
                        { type: 'image', src: 'images/avater6.jpg', alt: 'صورة من المعرض', title: 'معرض' }
                    );
                }
                
                return relatedItems;
            }
        }

        // Create global gallery manager instance
        const galleryManager = new GalleryManager();

        // Add methods to GalleryManager class
        Object.assign(GalleryManager.prototype, {
            createModal() {
                if (this.modal) {
                    this.modal.remove();
                }

                this.modal = document.createElement('div');
                this.modal.id = 'galleryModal';
                this.modal.className = 'gallery-modal';
                this.modal.innerHTML = `
                    <div class="gallery-content">
                        <button class="gallery-close" onclick="galleryManager.closeModal()" title="إغلاق المعرض">
                            <i class="fas fa-times"></i>
                        </button>
                        <button class="gallery-nav gallery-prev" onclick="galleryManager.previousSlide()" title="السابق">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        <button class="gallery-nav gallery-next" onclick="galleryManager.nextSlide()" title="التالي">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div class="gallery-slides"></div>
                        <div class="gallery-thumbnails"></div>
                        <div class="gallery-counter"></div>
                    </div>
                `;
                
                document.body.appendChild(this.modal);
                this.setupEventListeners();
            },

            showModal() {
                if (!this.modal) return;
                
                this.populateSlides();
                this.modal.classList.add('show');
                document.body.style.overflow = 'hidden';
                this.updateDisplay();
            },

            populateSlides() {
                const slidesContainer = this.modal.querySelector('.gallery-slides');
                const thumbnailsContainer = this.modal.querySelector('.gallery-thumbnails');
                
                slidesContainer.innerHTML = '';
                thumbnailsContainer.innerHTML = '';
                
                this.items.forEach((item, index) => {
                    // Create slide
                    const slide = document.createElement('div');
                    slide.className = `gallery-slide ${index === this.currentIndex ? 'active' : ''}`;
                    
                    if (item.type === 'image') {
                        slide.innerHTML = `
                            <img src="${item.src}" 
                                 alt="${item.alt}" 
                                 onerror="this.src='images/avater.jpg'"
                                 loading="lazy">
                        `;
                    } else {
                        slide.innerHTML = `
                            <video controls poster="${item.poster || ''}">
                                <source src="${item.src}" type="video/mp4">
                                متصفحك لا يدعم تشغيل الفيديو
                            </video>
                        `;
                    }
                    
                    slidesContainer.appendChild(slide);
                    
                    // Create thumbnail
                    const thumb = document.createElement('div');
                    thumb.className = `gallery-thumb ${index === this.currentIndex ? 'active' : ''}`;
                    thumb.onclick = () => this.goToSlide(index);
                    
                    if (item.type === 'image') {
                        thumb.innerHTML = `
                            <img src="${item.src}" 
                                 alt="${item.alt}" 
                                 onerror="this.src='images/avater.jpg'">
                        `;
                    } else {
                        thumb.innerHTML = `
                            <img src="${item.poster || 'images/avater.jpg'}" 
                                 alt="${item.alt}">
                        `;
                    }
                    
                    thumbnailsContainer.appendChild(thumb);
                });
            },

            setupEventListeners() {
                if (!this.modal) return;

                // Touch events
                this.modal.addEventListener('touchstart', (e) => this.handleTouchStart(e), { passive: false });
                this.modal.addEventListener('touchmove', (e) => this.handleTouchMove(e), { passive: false });
                this.modal.addEventListener('touchend', (e) => this.handleTouchEnd(e), { passive: false });

                // Mouse events
                this.modal.addEventListener('mousedown', (e) => this.handleMouseDown(e));
                this.modal.addEventListener('mousemove', (e) => this.handleMouseMove(e));
                this.modal.addEventListener('mouseup', (e) => this.handleMouseUp(e));

                // Click outside to close
                this.modal.addEventListener('click', (e) => {
                    if (e.target === this.modal) {
                        this.closeModal();
                    }
                });

                // Keyboard events
                document.addEventListener('keydown', (e) => this.handleKeyDown(e));
            },

            handleTouchStart(e) {
                if (!this.modal.classList.contains('show')) return;
                
                this.touchStartX = e.touches[0].clientX;
                this.touchStartY = e.touches[0].clientY;
                this.isSwipeStarted = true;
            },

            handleTouchMove(e) {
                if (!this.isSwipeStarted) return;
                e.preventDefault();
            },

            handleTouchEnd(e) {
                if (!this.isSwipeStarted || !this.modal.classList.contains('show')) return;
                
                const endX = e.changedTouches[0].clientX;
                const endY = e.changedTouches[0].clientY;
                const diffX = this.touchStartX - endX;
                const diffY = this.touchStartY - endY;
                
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 30) {
                    e.preventDefault();
                    if (diffX > 0) {
                        this.nextSlide();
                    } else {
                        this.previousSlide();
                    }
                }
                
                this.isSwipeStarted = false;
            },

            handleMouseDown(e) {
                if (!this.modal.classList.contains('show')) return;
                
                this.isMouseDown = true;
                this.mouseStartX = e.clientX;
                e.preventDefault();
            },

            handleMouseMove(e) {
                if (!this.isMouseDown) return;
                e.preventDefault();
            },

            handleMouseUp(e) {
                if (!this.isMouseDown || !this.modal.classList.contains('show')) return;
                
                const mouseEndX = e.clientX;
                const diffX = this.mouseStartX - mouseEndX;
                
                if (Math.abs(diffX) > 50) {
                    if (diffX > 0) {
                        this.nextSlide();
                    } else {
                        this.previousSlide();
                    }
                }
                
                this.isMouseDown = false;
            },

            handleKeyDown(e) {
                if (!this.modal || !this.modal.classList.contains('show')) return;
                
                switch(e.key) {
                    case 'ArrowLeft':
                        this.nextSlide();
                        break;
                    case 'ArrowRight':
                        this.previousSlide();
                        break;
                    case 'Escape':
                        this.closeModal();
                        break;
                }
            },

            nextSlide() {
                if (this.isAnimating) return;
                
                this.currentIndex = (this.currentIndex + 1) % this.items.length;
                this.updateDisplay();
            },

            previousSlide() {
                if (this.isAnimating) return;
                
                this.currentIndex = (this.currentIndex - 1 + this.items.length) % this.items.length;
                this.updateDisplay();
            },

            goToSlide(index) {
                if (this.isAnimating || index === this.currentIndex) return;
                
                this.currentIndex = index;
                this.updateDisplay();
            },

            updateDisplay() {
                const slides = this.modal.querySelectorAll('.gallery-slide');
                const thumbs = this.modal.querySelectorAll('.gallery-thumb');
                const counter = this.modal.querySelector('.gallery-counter');
                
                slides.forEach((slide, index) => {
                    slide.classList.toggle('active', index === this.currentIndex);
                });
                
                thumbs.forEach((thumb, index) => {
                    thumb.classList.toggle('active', index === this.currentIndex);
                });
                
                if (counter) {
                    counter.textContent = `${this.currentIndex + 1} / ${this.items.length}`;
                }
            },

            closeModal() {
                if (!this.modal) return;
                
                try {
                    // Remove show class to trigger close animation
                    this.modal.classList.remove('show');
                    
                    // Restore body scroll
                    document.body.style.overflow = 'auto';
                    
                    // Clean up event listeners
                    this.cleanupEventListeners();
                    
                    // Remove modal from DOM after animation
                    setTimeout(() => {
                        if (this.modal && this.modal.parentNode) {
                            this.modal.parentNode.removeChild(this.modal);
                        }
                        this.modal = null;
                        this.items = [];
                        this.currentIndex = 0;
                    }, 300);
                    
                } catch (error) {
                    console.error('Error closing gallery:', error);
                    // Force cleanup if there's an error
                    if (this.modal && this.modal.parentNode) {
                        this.modal.parentNode.removeChild(this.modal);
                    }
                    this.modal = null;
                    document.body.style.overflow = 'auto';
                }
            },

            cleanupEventListeners() {
                if (!this.modal) return;
                
                // Remove keyboard listener
                document.removeEventListener('keydown', this.handleKeyDown);
                
                // Remove modal event listeners
                this.modal.removeEventListener('touchstart', this.handleTouchStart);
                this.modal.removeEventListener('touchmove', this.handleTouchMove);
                this.modal.removeEventListener('touchend', this.handleTouchEnd);
                this.modal.removeEventListener('mousedown', this.handleMouseDown);
                this.modal.removeEventListener('mousemove', this.handleMouseMove);
                this.modal.removeEventListener('mouseup', this.handleMouseUp);
                this.modal.removeEventListener('click', this.handleClick);
            },

            showError(message) {
                Toastify({
                    text: message,
                    duration: 3000,
                    gravity: "top",
                    position: 'left',
                    backgroundColor: "linear-gradient(to right, #dc3545, #c82333)",
                    stopOnFocus: true
                }).showToast();
            }
        });

        // Initialize gallery controls when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Regular story cards
            document.querySelectorAll('.story-card').forEach(card => {
                galleryManager.createGalleryControls(card);
            });
            
            // Featured story
            const featured = document.querySelector('.featured-story-card');
            if (featured) {
                galleryManager.createGalleryControls(featured);
            }
        });
        
        // Navbar scroll effect
        window.addEventListener('scroll', function() {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });
        
        // Scroll to top button
        const scrollTop = document.getElementById('scrollTop');
        
        window.addEventListener('scroll', function() {
            if (window.scrollY > 300) {
                scrollTop.classList.add('show');
            } else {
                scrollTop.classList.remove('show');
            }
        });
        
        scrollTop.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href');
                if (href !== '#' && document.querySelector(href)) {
                    e.preventDefault();
                    const target = document.querySelector(href);
                    const offsetTop = target.offsetTop - 80;
                    
                    window.scrollTo({
                        top: offsetTop,
                        behavior: 'smooth'
                    });
                }
            });
        });
    </script>
</body>
</html>
